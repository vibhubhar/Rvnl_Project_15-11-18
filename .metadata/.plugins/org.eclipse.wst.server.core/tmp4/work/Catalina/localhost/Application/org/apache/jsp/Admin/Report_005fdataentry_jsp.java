/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.86
 * Generated at: 2018-05-04 05:15:27 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.Admin;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import javax.naming.*;
import java.sql.*;
import javax.sql.*;
import java.io.FileOutputStream;
import javax.servlet.*;
import javax.servlet.http.*;
import java.util.*;
import javax.naming.*;
import java.sql.*;
import javax.sql.*;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.Element;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.pdf.BaseFont;
import com.itextpdf.text.BaseColor;
import com.itextpdf.text.Font;
import java.awt.Color;
import com.itextpdf.text.pdf.PdfWriter;
import com.itextpdf.text.Document;
import com.itextpdf.text.Chunk;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.text.DateFormat;
import org.joda.time.DateTime;
import org.joda.time.Days;
import org.joda.time.Hours;
import org.joda.time.Minutes;
import org.joda.time.Seconds;
import com.rvnl.javascript.MySessionCounter;

public final class Report_005fdataentry_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);
    _jspx_dependants.put("/WEB-INF/sessionCheck1.jspf", Long.valueOf(1524567358000L));
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=ISO-8859-1");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 1120256, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

 
int timeout = session.getMaxInactiveInterval();
response.setHeader("Refresh", timeout + "; URL = admn_login.jsp");

      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("<style>\r\n");
      out.write(".dt-button.buttons-copy.buttons-html5 {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write(".dt-button.buttons-csv.buttons-html5 {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write(".dt-button.buttons-pdf.buttons-html5 {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write("#example_length {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write("#example {\r\n");
      out.write("    width: inherit;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("table {\r\n");
      out.write("\tmso-displayed-decimal-separator: \"\\.\";\r\n");
      out.write("\tmso-displayed-thousand-separator: \"\\,\";\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("@page {\r\n");
      out.write("\tmargin: 1.0in .75in 1.0in .75in;\r\n");
      out.write("\tmso-header-margin: .5in;\r\n");
      out.write("\tmso-footer-margin: .5in;\r\n");
      out.write("\tmso-page-orientation: landscape;\r\n");
      out.write("}\r\n");
      out.write("</style>\r\n");
      out.write("\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.css\" rel=\"stylesheet\" />\r\n");
      out.write("<!-- <title>PIU Level Report</title> -->\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<script src=\"resources/JS/validateSysAdmin230.js\"></script>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"https://code.jquery.com/jquery-1.12.4.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"https://code.jquery.com/ui/1.12.1/jquery-ui.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"http://www.allmyscripts.com/Table_Sort/beta/gs_sortable.js\"></script>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js\"></script>\r\n");
      out.write("<script\r\n");
      out.write("\tsrc=\"http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/jquery-ui.js\"\r\n");
      out.write("\ttype=\"text/javascript\"></script>\r\n");
      out.write("<script src=\"resources/JS/Approval_wf230.js\"></script>\r\n");
      out.write("<link\r\n");
      out.write("\thref=\"http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/themes/blitzer/jquery-ui.css\"\r\n");
      out.write("\trel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("\r\n");
      out.write("<link href=\"resources/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\r\n");
      out.write("<link rel=\"stylesheet\"\r\n");
      out.write("\thref=\"//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css\">\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.css\" rel=\"stylesheet\" />\r\n");
      out.write("<script src=\"resources/JS/backButton.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/validate230.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/PIU_depend230.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"resources/JS/datasort.js\"></script>\r\n");
      out.write("\t<link\r\n");
      out.write("\thref=\"https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css\"\r\n");
      out.write("\trel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("\t\r\n");
      out.write("<link href=\"resources/css/buttons.dataTables.min.css\" rel=\"stylesheet\" type=\"text/css\">\r\n");
      out.write("<script src=\"resources/JS/jquery-1.12.4.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/jquery.dataTables.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/dataTables.buttons.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/buttons.flash.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/jszip.min.js\"></script>\r\n");
      out.write("<!-- <script src=\"resources/JS/pdfmake.min.js\"></script> -->\r\n");
      out.write("<script src=\"resources/JS/vfs_fonts.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/buttons.print.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/buttons.html5.min.js\"></script>\r\n");
      out.write("<script>\r\n");
      out.write("function myFunction() {\r\n");
      out.write("    window.print();\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("function closeMe()\r\n");
      out.write("{\r\n");
      out.write("var win = window.open(\"\",\"_self\"); \r\n");
      out.write("win.close();\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("function mywinClose() {\r\n");
      out.write("\tvar sessionTimeout1 = \"");
      out.print( session.getMaxInactiveInterval() );
      out.write("\";\r\n");
      out.write("\tsetTimeout(function(){var parent1=window.open(\"\",\"report_master\"); parent1.close(); },(sessionTimeout1-10)*1000);\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("\r\n");
      out.write("\t<script>\r\n");
      out.write("\t$(document).ready(function() {\r\n");
      out.write("\t\t/*\r\n");
      out.write("\t   \t\t$('#example').DataTable( {\r\n");
      out.write("\t      \t\t\t\r\n");
      out.write("\t   \t\t  \t\"infoCallback\": function( settings, start, end, max, total, pre ) {\r\n");
      out.write("\t\t\t\tif (max==total) { return \"Showing \" + (end-start+1) + \"  of \" +total+\" records\"}\r\n");
      out.write("\t\t\t\telse {return \"Showing \" + (end-start+1) + \"  of \" +total+\" records (filtered from total \" + max+\" records)\"}\r\n");
      out.write("\t\t\t   \t},\r\n");
      out.write("\t   \r\n");
      out.write("\t\t\t \r\n");
      out.write("\t        dom: 'Bfrtip',\r\n");
      out.write("\t        lengthMenu: [\r\n");
      out.write("\t                     [ 10, 25, 50, -1 ],\r\n");
      out.write("\t                     [ '10 rows', '25 rows', '50 rows', 'Show all' ]\r\n");
      out.write("\t                 ],\r\n");
      out.write("\t        buttons: [\r\n");
      out.write(" 'pageLength',\r\n");
      out.write("\r\n");
      out.write("\t                  \r\n");
      out.write("{exportOptions: {\r\n");
      out.write("\t  \r\n");
      out.write("\t columns: [0,1,2,3]\r\n");
      out.write("},\r\n");
      out.write("    extend: 'print',\r\n");
      out.write("    message: \"\",\r\n");
      out.write("    title: 'RVNL DATA ENTRY REPORT',\r\n");
      out.write("    customize: function (win) {\r\n");
      out.write("        $(win.document.body).find('table').addClass('display').css('font-size', '9px');\r\n");
      out.write("        $(win.document.body).find('tr:nth-child(odd) td').each(function(index){\r\n");
      out.write("            $(this).css('background-color','#D0D0D0');\r\n");
      out.write("        });\r\n");
      out.write("        $(win.document.body).find('h1').css('text-align','center');\r\n");
      out.write("    }\r\n");
      out.write("}]\r\n");
      out.write("\t   \t\t/*,\r\n");
      out.write("\t                  \r\n");
      out.write("{exportOptions: {\r\n");
      out.write("   columns: [0,1,2,3]\r\n");
      out.write("}, \r\n");
      out.write("\t                  \r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  //'print',\r\n");
      out.write("\t\t                \r\n");
      out.write("\t\t                 title: 'RVNL DATA ENTRY REPORT',\r\n");
      out.write("\t\t                  extend: 'excel',\r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                 \r\n");
      out.write("\t\t                  fixedHeader: {\r\n");
      out.write("\t\t                      header: true,\r\n");
      out.write("\t\t                      footer: true\r\n");
      out.write("\t\t                  },\r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  customize: function (xlsx) {\r\n");
      out.write("\t\t                      var sheet = xlsx.xl.worksheets['sheet1.xml'];\r\n");
      out.write("\t\t                      var numrows = 1;\r\n");
      out.write("\t\t                      var clR = $('row', sheet);\r\n");
      out.write("\r\n");
      out.write("\t\t                      //update Row\r\n");
      out.write("\t\t                      clR.each(function () {\r\n");
      out.write("\t\t                          var attr = $(this).attr('r');\r\n");
      out.write("\t\t                          var ind = parseInt(attr);\r\n");
      out.write("\t\t                          ind = ind + numrows;\r\n");
      out.write("\t\t                          $(this).attr(\"r\",ind);\r\n");
      out.write("\t\t                      });\r\n");
      out.write("\t\t                     // var message33=document.getElementById(\"message1\").value;\r\n");
      out.write("\t\t                      // Create row before data\r\n");
      out.write("\t\t                      $('row c ', sheet).each(function () {\r\n");
      out.write("\t\t                          var attr = $(this).attr('r');\r\n");
      out.write("\t\t                          var pre = attr.substring(0, 1);\r\n");
      out.write("\t\t                          var ind = parseInt(attr.substring(1, attr.length));\r\n");
      out.write("\t\t                          ind = ind + numrows;\r\n");
      out.write("\t\t                          $(this).attr(\"r\", pre + ind);\r\n");
      out.write("\t\t                      });\r\n");
      out.write("\r\n");
      out.write("\t\t                      function Addrow(index,data) {\r\n");
      out.write("\t\t                          msg='<row r=\"'+index+'\">'\r\n");
      out.write("\t\t                          for(i=0;i<data.length;i++){\r\n");
      out.write("\t\t                              var key=data[i].key;\r\n");
      out.write("\t\t                              var value=data[i].value;\r\n");
      out.write("\t\t                              msg += '<c t=\"inlineStr\" r=\"' + key + index + '\">';\r\n");
      out.write("\t\t                              msg += '<is>';\r\n");
      out.write("\t\t                              msg +=  '<t>'+value+'</t>';\r\n");
      out.write("\t\t                              msg+=  '</is>';\r\n");
      out.write("\t\t                              msg+='</c>';\r\n");
      out.write("\t\t                          }\r\n");
      out.write("\t\t                          msg += '</row>';\r\n");
      out.write("\t\t                          return msg;\r\n");
      out.write("\t\t                      }\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t                      //insert\r\n");
      out.write("\t\t                      var r1 = Addrow(1, [{ key: 'B', value:  'RVNL DATA ENTRY REPORT' }]);\r\n");
      out.write("\t\t                      \r\n");
      out.write("\t\t                      sheet.childNodes[0].childNodes[1].innerHTML = r1+ sheet.childNodes[0].childNodes[1].innerHTML;\t\t                  \r\n");
      out.write("\t\t                      }\r\n");
      out.write("\t\t                  \t                  \r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  }\r\n");
      out.write("\t                  \r\n");
      out.write("\t                  ]\r\n");
      out.write("\t\t\t   */\r\n");
      out.write("\t\t\t   });\t\r\n");
      out.write("\t    \r\n");
      out.write("\t\r\n");
      out.write("\t\r\n");
      out.write("\t</script>\r\n");
      out.write("\t\r\n");
      out.write("\r\n");
      out.write("</head>\r\n");
      out.write("<body onload=\"mywinClose();\">\r\n");
      out.write("\t<div style=\"text-align: center;font-size: 18px;\"><b>RVNL DATA ENTRY REPORT </b></div></br>\r\n");
      out.write("\t<br><br> Active Sessions : ");
      out.print( MySessionCounter.getActiveSessions() );
      out.write(" <br><br>\r\n");
      out.write("\t");

		String exportToExcel = request.getParameter("exportToExcel");
	Connection conn = null;
	Statement stmt = null, stmt11=null;
	ResultSet rs = null,rs11=null;
	String arguments=null;
	int i=0;
	try {
	Context initCtx = new InitialContext();
	Context envCtx = (Context) initCtx.lookup("java:comp/env");
	DataSource ds = (DataSource) envCtx.lookup("jdbc/MySQLDB");

	conn = ds.getConnection();

	
	//String reportType = request.getParameter("report_type");
	//System.out.println("report:"+reportType);
	//if (reportType.equalsIgnoreCase("zonewise")) {
		String query11="select z.Zone_Name, count(u.User_name) from xx_zones_master z left join xx_user_master u on z.Zone_Id = u.Zone_ID  group by z.Zone_id order by  z.Zone_Id";
		System.out.println("query:"+query11);
		stmt11 = conn.createStatement();
		rs11 = stmt11.executeQuery(query11);
		
	
      out.write("\r\n");
      out.write("<br> \r\n");
      out.write("<span style=\"margin-left:20px; color:blue; font-weight:bold; font-size:18px;\">Zone wise Users Creation Summary</span><br>\r\n");
      out.write("<table > <tr> <td valign=\"top\" width=\"30%\">\r\n");
      out.write("\t<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("\t\tstyle=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"10\" width=\"100%\">\r\n");
      out.write("\t\t<thead>\r\n");
      out.write("\t\t<tr class=\"success\">\r\n");
      out.write("\t\t\t<th style=\"padding: 0px 14px 24px 0px;\">S.No.</th>\r\n");
      out.write("\t\t\t<th style=\"padding: 0px 18px 17px 14px; \">Zone</th>\r\n");
      out.write("\t\t\t<th width=\"140px\">Nos. of Users Created</th>\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t</tr></thead>\r\n");
      out.write("\t\t<tbody>\r\n");
      out.write("\t\t");

			 i = 1;
			while (rs11.next()) {

				String zone = rs11.getString(1);
				//String div = rs11.getString(2);
				String noUsers = rs11.getString(2);
				System.out.println("data:"+zone+noUsers);
						
      out.write("\r\n");
      out.write("\t\t<tr class=\"active\">\r\n");
      out.write("\t\t\t<td >");
      out.print(i);
      out.write("</td>\r\n");
      out.write("\t\t\t<td >");
      out.print(zone);
      out.write("</td>\r\n");
      out.write("\t\t\t<td >");
      out.print(noUsers);
      out.write("</td>\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t</tr>\r\n");
      out.write("\t\t");

			i++;
			}
			rs11.close();
			stmt11.close();
			
		
      out.write("\r\n");
      out.write("\t\t</tbody>\r\n");
      out.write("\t</table>\r\n");
      out.write("\t\r\n");
      out.write("\t<br>\t<br>\r\n");
      out.write("\t");

	//} else if (reportType.equalsIgnoreCase("zonedivwise")) {
		
				//String query="select z.Zone_Name, d.division_name,  count(u.User_name) from xx_zones_master z left join xx_divisions_map d on z.Zone_Id=d.Ext_Zone_Id left join xx_user_master u on d.Division_Id = u.Division_ID where d.Division_Name!='Headquarters' group by z.Zone_name, d.division_name Union all select z.Zone_Name, 'HQ' as division_name,  count(u.User_name) from xx_zones_master z left join xx_user_master u on z.Zone_Id = u.Zone_ID and u.Division_ID =86  group by z.Zone_id order by  Zone_name, Division_Name";
				String query="select c.Zone_Name as Zone, a.Division_Name as Division, b.ucount as Users_Created, b.DRM_GM_Users, d.pcount as Docs_Created from xx_zones_master c left join xx_divisions_map a on c.Zone_Id = a.Ext_Zone_Id left join (select division_id, count(user_Id) as ucount, count(if(designation_id=75,1,null)) as DRM_GM_Users from xx_user_master group by division_id) b on a.Division_Id = b.Division_ID left join (select division, count(document_map_id) as pcount from xx_document_mapping group by division) d on a.Division_name = d.Division where cast(a.division_id as signed) <70  union select c.Zone_Name as Zone,'Headquarters' as Division, b.ucount as Users_Created, b.DRM_GM_Users, d.pcount as Docs_Created from xx_zones_master c left join (select zone_id, count(user_Id) as ucount, count(if(designation_id=115,1,null)) as DRM_GM_Users from xx_user_master  where division_id=86 group by zone_id) b on c.zone_Id = b.zone_ID left join (select zone, count(document_map_id) as pcount from xx_document_mapping group by zone) d on c.zone_name = d.zone  order by Zone, (Division = 'Headquarters') DESC, Division";
				//System.out.println("query:"+query);
		stmt = conn.createStatement();
		rs = stmt.executeQuery(query);
	
      out.write("\r\n");
      out.write("</td><td valign=\"top\" width=\"35%\" rowspan=\"2\">\r\n");
      out.write("<span style=\"margin-left:20px; color:blue; font-weight:bold; font-size:18px;\">Zone/Division wise Users Creation Summary</span><br>\r\n");
      out.write("\t\r\n");
      out.write("\t<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("\t\tstyle=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("\t\t<thead>\r\n");
      out.write("\t\t<tr class=\"success\">\r\n");
      out.write("\t\t\t<th style=\"padding: 0px 14px 24px 0px;\">S.No.</th>\r\n");
      out.write("\t\t\t<th style=\"padding: 0px 18px 17px 14px; \">Zone</th>\r\n");
      out.write("\t\t\t<th style=\"padding: 0px 0px 26px 19px;\">Division</th>\r\n");
      out.write("\t\t\t<th width=\"140px\">Nos. of Users Created</th>\r\n");
      out.write("\t\t\t<th width=\"140px\">Nos. of DRMs/GMs Created</th>\r\n");
      out.write("\t\t\t<th width=\"140px\">Nos. of Documents Created</th>\r\n");
      out.write("\t\t\t</tr></thead>\r\n");
      out.write("\t\t<tbody>\r\n");
      out.write("\t\t");

			 i = 1;
			while (rs.next()) {

				String zone = rs.getString(1);
				String div = rs.getString(2);
				String noUsers = rs.getString(3);
				String noDRM_GM = rs.getString(4);
				String noDocs = rs.getString(5);
						
      out.write("\r\n");
      out.write("\t\t<tr class=\"active\">\r\n");
      out.write("\t\t\t<td>");
      out.print(i);
      out.write("</td>\r\n");
      out.write("\t\t\t<td>");
      out.print(zone);
      out.write("</td>\r\n");
      out.write("\t\t\t<td>");
      out.print(div);
      out.write("</td>\r\n");
      out.write("\t\t\t<td>");
      out.print(noUsers);
      out.write("</td>\r\n");
      out.write("\t\t\t<td>");
      out.print(noDRM_GM);
      out.write("</td>\r\n");
      out.write("\t\t\t<td>");
      out.print(noDocs);
      out.write("</td>\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t</tr>\r\n");
      out.write("\t\t");

			i++;
			}
			rs.close();
			stmt.close();
			
		
      out.write("\r\n");
      out.write("\t\t</tbody>\r\n");
      out.write("\t</table>\r\n");
      out.write("\t<span style=\"color:red; background-color:yellow; font-style:italic;\">Note: 'Nos. of Docs Created' shown against 'Headquarters' in above table is total sum of those created for all divisions of that zone.</span>\r\n");
      out.write("\t<br><br>\r\n");
      out.write("\t");

//	} else if (reportType.equalsIgnoreCase("piuwise")) {
		
		 query="select p.piu_Name,   count(u.User_name) from xx_piu_master p left join xx_user_master u on u.PIU_ID = p.piu_id group by p.piu_name";
//System.out.println("query:"+query);
stmt = conn.createStatement();
rs = stmt.executeQuery(query);

      out.write("\r\n");
      out.write("</td></tr>\r\n");
      out.write("<tr><td valign=\"top\" width=\"35%\">\r\n");
      out.write("<span style=\"margin-left:20px; color:blue; font-weight:bold; font-size:18px;\">PIU wise Users Creation Summary</span><br>\r\n");
      out.write("<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("style=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("<thead>\r\n");
      out.write("<tr class=\"success\">\r\n");
      out.write("\t<th style=\"padding: 0px 14px 24px 0px;\">S.No.</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">PIU</th>\r\n");
      out.write("\t<th width=\"140px\">Nos. of Users Created</th>\r\n");
      out.write("\t\r\n");
      out.write("\t</tr></thead>\r\n");
      out.write("<tbody>\r\n");

	 i = 1;
	while (rs.next()) {

		String zone = rs.getString(1);
		//String div = rs.getString(2);
		String noUsers = rs.getString(2);
				
      out.write("\r\n");
      out.write("<tr class=\"active\">\r\n");
      out.write("\t<td>");
      out.print(i);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(zone);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(noUsers);
      out.write("</td>\r\n");
      out.write("\t\r\n");
      out.write("</tr>\r\n");

	i++;
	}
	rs.close();
	stmt.close();
	

      out.write("\r\n");
      out.write("</tbody>\r\n");
      out.write("</table>\r\n");
      out.write("<br><br>\r\n");

//	} else if (reportType.equalsIgnoreCase("project")) {
		
	 query="select a.piu_name,   count(b.project), sum(b.PackageOfProject), count(if(b.completed='y',1,null)) from xx_piu_master a left join xx_projectattributes_master b on a.PIU_Name=b.PIU_of_RVNL group by piu_name";
//System.out.println("query:"+query);
stmt = conn.createStatement();
rs = stmt.executeQuery(query);

      out.write("\r\n");
      out.write("</td></tr><tr><td>\r\n");
      out.write("<span style=\"margin-left:80px; color:blue; font-weight:bold; font-size:18px;\">PIU wise Project-Package Creation Summary</span><br>\r\n");
      out.write("<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("style=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("<thead>\r\n");
      out.write("<tr class=\"success\">\r\n");
      out.write("\t<th style=\"padding: 0px 14px 24px 0px;\">S.No.</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">PIU</th>\r\n");
      out.write("\t<th width=\"140px\">Nos. of Projects Created</th>\r\n");
      out.write("\t<th width=\"140px\">Nos. of Packages</th>\r\n");
      out.write("\t<th width=\"140px\">Nos. of Packages Created</th>\r\n");
      out.write("\t</tr></thead>\r\n");
      out.write("<tbody>\r\n");

	 i = 1;
	while (rs.next()) {

		String zone = rs.getString(1);
		//String div = rs.getString(2);
		String noUsers = rs.getString(2);
		String noUsers1 = rs.getString(3);
		String noUsers2 = rs.getString(4);
				
      out.write("\r\n");
      out.write("<tr class=\"active\">\r\n");
      out.write("\t<td>");
      out.print(i);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(zone);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(noUsers);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(noUsers1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(noUsers2);
      out.write("</td>\r\n");
      out.write("</tr>\r\n");

	i++;
	}
	rs.close();
	stmt.close();
	

      out.write("\r\n");
      out.write("</tbody>\r\n");
      out.write("</table>\r\n");
      out.write("<br><br>\r\n");

//	} else if (reportType.equalsIgnoreCase("docs")) {
		
 query="select a.piu_name,  count(c.Document_Map_ID), count(if(c.Forwarded='yes',1,null)) from xx_piu_master a left join xx_projectattributes_master b on a.PIU_Name=b.PIU_of_RVNL left join xx_document_mapping c on b.Project_ID = c.Project_ID  group by a.piu_name";
//System.out.println("query:"+query);
stmt = conn.createStatement();
rs = stmt.executeQuery(query);

      out.write("\r\n");
      out.write("</td><td>\r\n");
      out.write("<span style=\"margin-left:20px; color:blue; font-weight:bold; font-size:18px;\">PIU wise Documents Creation & Forwarding Summary</span><br>\r\n");
      out.write("<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("style=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("<thead>\r\n");
      out.write("<tr class=\"success\">\r\n");
      out.write("\t<th style=\"padding: 0px 14px 24px 0px;\">S.No.</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">PIU</th>\r\n");
      out.write("\t<th width=\"140px\">Nos. of Documents Created</th>\r\n");
      out.write("\t<th width=\"140px\">Nos. of Documents Forwarded to Rlys</th>\r\n");
      out.write("\t</tr></thead>\r\n");
      out.write("<tbody>\r\n");

	 i = 1;
	while (rs.next()) {

		String zone = rs.getString(1);
		//String div = rs.getString(2);
		String noUsers = rs.getString(2);
		String noUsers1 = rs.getString(3);
				
      out.write("\r\n");
      out.write("<tr class=\"active\">\r\n");
      out.write("\t<td>");
      out.print(i);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(zone);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(noUsers);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(noUsers1);
      out.write("</td>\r\n");
      out.write("</tr>\r\n");

	i++;
	}
	rs.close();
	stmt.close();

      out.write("\r\n");
      out.write("</tbody>\r\n");
      out.write("</table>\r\n");
      out.write("</td></tr>\r\n");
      out.write("<tr><td colspan=\"2\"><br><br>\r\n");
      out.write("<span style=\"margin-left:250px; color:blue; font-weight:bold; font-size:18px;\">Project Documents Movement Summary for last 15 days</span><br>\r\n");

//	} else if (reportType.equalsIgnoreCase("docs")) {
query="select date(Real_ActionDate) as Date1, count(if(ActionPerformed='Submitted',1,null)) as Nos_Submitted, count(if(ActionPerformed='Resubmitted',1,null)) as Nos_Resubmitted, count(if(ActionPerformed='Pulled back by RVNL',1,null)) as Nos_pulledBack, count(if(ActionPerformed='Forward With Approval',1,null)) as Nos_Fwd_appd, count(if(ActionPerformed='Returned to RVNL with approval',1,null)) as Nos_retnd_appd, count(if(ActionPerformed='Returned to RVNL',1,null)) as Nos_retnd_unappd, count(if(ActionPerformed='Forward without Approval',1,null)) as Nos_Fwd_unappd from xx_record_actions where date(Real_ActionDate) between  DATE_ADD(CURDATE(), INTERVAL -15 day) and CURDATE()  group by date(Real_ActionDate)";
//"select DATE_format(Last_login,'%d/%m/%Y') as dd, Count(if (Type='MOR',1, null)) AS MOR_Users_logged, Count(if (Type='MOR' and Designation_Id=75,1, null)) AS DRMs_logged,Count(if (Type='MOR' and Designation_Id=115,1, null)) AS GMs_logged, Count(if (Type='RVNL',1, null)) AS RVNL_Users_logged, Count(if (Type='RVNL' and (Role='LocalUser' or Role='System Administrator'),1, null)) AS RVNL_Admins_logged, count(User_id) as Total_Users_logged from xx_user_master where Last_login between DATE_ADD(CURDATE(), INTERVAL -15 day) and now()  group by DATE_format(Last_login,'%d/%m/%Y') order by Last_login";		
System.out.println("query:"+query);
stmt = conn.createStatement();
rs = stmt.executeQuery(query);

      out.write("\r\n");
      out.write("<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("style=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("<thead>\r\n");
      out.write("<tr class=\"success\">\r\n");
      out.write("\t<th width=\"100px\" >Date</th>\r\n");
      out.write("\t<th >Nos. Submitted (RVNL)</th>\r\n");
      out.write("\t<th>Nos. Resubmitted (RVNL)</th>\r\n");
      out.write("\t<th>Nos. Pulled Back (RVNL)</th>\r\n");
      out.write("\t<th>Nos. Forwarded with approval (Rly)</th>\r\n");
      out.write("\t<th>Nos. Returned to RVNL with approval (Rly)</th>\r\n");
      out.write("\t<th>Nos. Returned to RVNL without approval (Rly)</th>\r\n");
      out.write("\t<th>Nos. Forwarded without approval (Rly)</th>\r\n");
      out.write("\t</tr></thead>\r\n");
      out.write("<tbody>\r\n");

	 i = 1;
	while (rs.next()) {

		String col1 = rs.getString(1);
		String col2 = rs.getString(2);
		String col3 = rs.getString(3);
		String col4 = rs.getString(4);
		String col5 = rs.getString(5);
		String col6 = rs.getString(6);
		String col7 = rs.getString(7);
		String col8 = rs.getString(8);
		
      out.write("\r\n");
      out.write("<tr class=\"active\">\r\n");
      out.write("\t<td>");
      out.print(col1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col2);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col3);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col4);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col5);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col6);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col7);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col8);
      out.write("</td>\r\n");
      out.write("\t</tr>\r\n");

	i++;
	}
	rs.close();
	stmt.close();

      out.write("\r\n");
      out.write("</tbody>\r\n");
      out.write("</table>\r\n");
      out.write("</td></tr>\r\n");
      out.write("<tr><td colspan=\"2\"><br><br>\r\n");
      out.write("<span style=\"margin-left:250px; color:blue; font-weight:bold; font-size:18px;\">Portal User Logins Summary for last 15 days</span><br>\r\n");

//	} else if (reportType.equalsIgnoreCase("docs")) {
query="select * from xx_logins where Date1 between DATE_ADD(CURDATE(), INTERVAL -15 day) and CURDATE() Union select "+
" DATE(Last_login) as Date1, Count(if (Type='MOR',1, null)) AS Rly_Total, Count(if (Type='MOR' and Designation_Id=75,1, null)) AS Rly_DRM,Count(if (Type='MOR' and Designation_Id=115,1, null)) AS Rly_GM, Count(if (Type='RVNL',1, null)) AS RVNL_Total, Count(if (Type='RVNL' and (Role='LocalUser' or Role='System Administrator'),1, null)) AS RVNL_Admins, count(User_id) as Total_Logins from xx_user_master where DATE(Last_login) = DATE(now()) ";		
System.out.println("query:"+query);
stmt = conn.createStatement();
rs = stmt.executeQuery(query);

      out.write("\r\n");
      out.write("<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("style=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("<thead>\r\n");
      out.write("<tr class=\"success\">\r\n");
      out.write("\t<th >Date</th>\r\n");
      out.write("\t<th >Nos. Logged (Rly all)</th>\r\n");
      out.write("\t<th>Nos. Logged (DRM)</th>\r\n");
      out.write("\t<th>Nos. Logged (GM)</th>\r\n");
      out.write("\t<th>Nos. Logged (RVNL all)</th>\r\n");
      out.write("\t<th>Nos. Logged (RVNL Admins)</th>\r\n");
      out.write("\t<th>Total Nos. of Users Logged</th>\r\n");
      out.write("\t</tr></thead>\r\n");
      out.write("<tbody>\r\n");

	 i = 1;
	while (rs.next()) {

		String col1 = rs.getString(1);
		String col2 = rs.getString(2);
		String col3 = rs.getString(3);
		String col4 = rs.getString(4);
		String col5 = rs.getString(5);
		String col6 = rs.getString(6);
		String col7 = rs.getString(7);
		
      out.write("\r\n");
      out.write("<tr class=\"active\">\r\n");
      out.write("\t<td>");
      out.print(col1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col2);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col3);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col4);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col5);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col6);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(col7);
      out.write("</td>\r\n");
      out.write("\t</tr>\r\n");

	i++;
	}
	rs.close();
	stmt.close();

      out.write("\r\n");
      out.write("</tbody>\r\n");
      out.write("</table>\r\n");
      out.write("</td></tr>\r\n");
      out.write("<tr><td colspan=\"2\"><br><br>\r\n");
      out.write("<span style=\"margin-left:250px; color:blue; font-weight:bold; font-size:18px;\">User logins during last 3 days</span><br>\r\n");

//	} else if (reportType.equalsIgnoreCase("docs")) {
		
 query="select last_login as dd, type, user_name,  Officer_Name, Email_Id, Contact_No from xx_user_master where Last_login between DATE_ADD(CURdate(), INTERVAL -3 day) and now() order by dd, type, User_name";
System.out.println("query:"+query);
stmt = conn.createStatement();
rs = stmt.executeQuery(query);

      out.write("\r\n");
      out.write("<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("style=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("<thead>\r\n");
      out.write("<tr class=\"success\">\r\n");
      out.write("\t<th >Date & Time of Login</th>\r\n");
      out.write("\t<th>Organization</th>\r\n");
      out.write("\t<th >User Id</th>\r\n");
      out.write("\t<th width=\"140px\">Name</th>\r\n");
      out.write("\t<th width=\"140px\">Email</th>\r\n");
      out.write("\t<th width=\"100px\">Mobile</th>\r\n");
      out.write("\t</tr></thead>\r\n");
      out.write("<tbody>\r\n");

	 i = 1;
	while (rs.next()) {

		String dd1 = rs.getString(1);
		String type1 = rs.getString(2);
		String uid = rs.getString(3);
		String name1 = rs.getString(4);
		String email1 = rs.getString(5);
		String mob1 = rs.getString(6);	
				
      out.write("\r\n");
      out.write("<tr class=\"active\">\r\n");
      out.write("\t<td>");
      out.print(dd1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(type1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(uid);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(name1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(email1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(mob1);
      out.write("</td>\r\n");
      out.write("\t</tr>\r\n");

	i++;
	}
	rs.close();
	stmt.close();

      out.write("\r\n");
      out.write("</tbody>\r\n");
      out.write("</table>\r\n");
      out.write("</td></tr>\r\n");
      out.write("<tr><td colspan=\"2\"><br><br>\r\n");
      out.write("<span style=\"margin-left:450px; color:blue; font-weight:bold; font-size:18px;\">RVNL Users Data Entry Details</span><br>\r\n");

//	} else if (reportType.equalsIgnoreCase("docs")) {
		
 query="select a.*, b.PIU_Name, e.Department_Name, f.Designation_Name from xx_user_master a, xx_piu_master b,  xx_departments_master e, xx_designation_master f  where a.PIU_ID = b.PIU_Id  and a.Department_id = e.Department_Id and a.Designation_Id = f.Designation_Id order by a.Type, b.PIU_Name, e.Department_Name, a.User_Name";
System.out.println("query:"+query);
stmt = conn.createStatement();
rs = stmt.executeQuery(query);

      out.write("\r\n");
      out.write("<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("style=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("<thead>\r\n");
      out.write("<tr class=\"success\">\r\n");
      out.write("\t<th style=\"padding: 0px 14px 24px 0px;\">S.No.</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Type</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">PIU</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Deptt.</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">User Id</th>\r\n");
      out.write("\t<th style=\"padding: 0px 14px 24px 0px;\">Regd Id</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Role</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Design.</th>\r\n");
      out.write("\t<th width=\"140px\">Name</th>\r\n");
      out.write("\t<th width=\"140px\">Email</th>\r\n");
      out.write("\t<th width=\"100px\">Mobile</th>\r\n");
      out.write("\t<th width=\"100px\">Mail Status</th>\r\n");
      out.write("\t<th width=\"100px\">Real Date Status</th>\r\n");
      out.write("\t<th width=\"100px\">Created By</th>\r\n");
      out.write("\t<th width=\"100px\">Date Created</th>\r\n");
      out.write("\t<th width=\"100px\">Theme</th>\r\n");
      out.write("\t<th width=\"100px\">Last_Login</th>\r\n");
      out.write("\t</tr></thead>\r\n");
      out.write("<tbody>\r\n");

	 i = 1;
	while (rs.next()) {

		String rid = rs.getString(1);
		String uid = rs.getString(2);
		String role1 = rs.getString(4);
		String type1 = rs.getString(5);
		String piu1 = rs.getString(21);
		String dept1 = rs.getString(22);
		String desgn1 = rs.getString(23);
		String name1 = rs.getString(12);
		String email1 = rs.getString(13);
		String mob1 = rs.getString(14);
		String mailstat1 = rs.getString(15);
		String realdate1 = rs.getString(16);
		String createdby = rs.getString(17);
		String date_created1 = rs.getString(18);
		String theme1 = rs.getString(19);
		String last_login1 = rs.getString(20);
		
				
      out.write("\r\n");
      out.write("<tr class=\"active\">\r\n");
      out.write("\t<td>");
      out.print(i);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(type1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(piu1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(dept1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(uid);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(rid);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(role1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(desgn1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(name1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(email1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(mob1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(mailstat1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(realdate1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(createdby);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(date_created1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(theme1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(last_login1);
      out.write("</td>\r\n");
      out.write("\t</tr>\r\n");

	i++;
	}
	rs.close();
	stmt.close();

      out.write("\r\n");
      out.write("</tbody>\r\n");
      out.write("</table>\r\n");
      out.write("\r\n");
      out.write("</td></tr><tr>\r\n");
      out.write("<td colspan=\"2\"><br><br>\r\n");
      out.write("<span style=\"margin-left:450px; color:blue; font-weight:bold; font-size:18px;\">Railway Users Data Entry Details</span><br>\r\n");

//	} else if (reportType.equalsIgnoreCase("docs")) {
		
 query="select a.*, c.Zone_Name, d.division_name, e.Department_Name, f.Designation_Name from xx_user_master a, xx_zones_master c, xx_divisions_master d, xx_departments_master e, xx_designation_master f  where  a.Zone_ID = c.Zone_Id and a.Division_ID = d.division_id and a.Department_id = e.Department_Id and a.Designation_Id = f.Designation_Id order by a.Type, c.Zone_Name, d.Division_Name='Headquarters' DESC, d.Division_Name, e.Department_Name, a.User_Name";
//System.out.println("query:"+query);
stmt = conn.createStatement();
rs = stmt.executeQuery(query);

      out.write("\r\n");
      out.write("<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("style=\"background-color: #F0FFFF; margin-left:20px;\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("<thead>\r\n");
      out.write("<tr class=\"success\">\r\n");
      out.write("\t<th style=\"padding: 0px 14px 24px 0px;\">S.No.</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Type</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Zone</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Division</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Deptt.</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">User Id</th>\r\n");
      out.write("\t<th style=\"padding: 0px 14px 24px 0px;\">Regd Id</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Role</th>\r\n");
      out.write("\t<th style=\"padding: 0px 18px 17px 14px; \">Design.</th>\r\n");
      out.write("\t<th width=\"140px\">Name</th>\r\n");
      out.write("\t<th width=\"140px\">Email</th>\r\n");
      out.write("\t<th width=\"100px\">Mobile</th>\r\n");
      out.write("\t<th width=\"100px\">Mail Status</th>\r\n");
      out.write("\t<th width=\"100px\">Real Date Status</th>\r\n");
      out.write("\t<th width=\"100px\">Created By</th>\r\n");
      out.write("\t<th width=\"100px\">Date Created</th>\r\n");
      out.write("\t<th width=\"100px\">Theme</th>\r\n");
      out.write("\t<th width=\"100px\">Last_Login</th>\r\n");
      out.write("\t</tr></thead>\r\n");
      out.write("<tbody>\r\n");

	 i = 1;
	while (rs.next()) {

		String rid = rs.getString(1);
		String uid = rs.getString(2);
		String role1 = rs.getString(4);
		String type1 = rs.getString(5);
		String zone1 = rs.getString(21);
		String divn1 = rs.getString(22);
		String dept1 = rs.getString(23);
		String desgn1 = rs.getString(24);
		String name1 = rs.getString(12);
		String email1 = rs.getString(13);
		String mob1 = rs.getString(14);
		String mailstat1 = rs.getString(15);
		String realdate1 = rs.getString(16);
		String createdby = rs.getString(17);
		String date_created1 = rs.getString(18);
		String theme1 = rs.getString(19);
		String last_login1 = rs.getString(20);
		
				
      out.write("\r\n");
      out.write("<tr class=\"active\">\r\n");
      out.write("\t<td>");
      out.print(i);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(type1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(zone1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(divn1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(dept1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(uid);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(rid);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(role1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(desgn1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(name1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(email1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(mob1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(mailstat1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(realdate1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(createdby);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(date_created1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(theme1);
      out.write("</td>\r\n");
      out.write("\t<td>");
      out.print(last_login1);
      out.write("</td>\r\n");
      out.write("\t</tr>\r\n");

	i++;
	}
	rs.close();
	stmt.close();
	 try { conn.close(); } catch (Exception e) { /* ignored */ }

      out.write("\r\n");
      out.write("</tbody>\r\n");
      out.write("</table>\r\n");
      out.write("</td>\r\n");
      out.write("</tr></table>\r\n");
      out.write("<br><br>\r\n");

	}catch(Exception e){
		
		e.printStackTrace();
	}  
	//}
	

      out.write("\r\n");
      out.write("\t\t<input type=\"button\" value=\"close\" class=\"btn btn-primary\" onclick=\"closeMe();\" style=\"margin-left: 50%;\"> \r\n");
      out.write("\t\r\n");
      out.write("\t");

		if (exportToExcel == null) {
	
	
		}
	
      out.write("\r\n");
      out.write("\t<br>\r\n");
      out.write("\t<!-- <a href=\"#\" onclick=\"javascript:window.print();\">Print this page</a> -->\r\n");
      out.write("\r\n");
      out.write("</body>\r\n");
      out.write("\r\n");
      out.write("</html>\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
