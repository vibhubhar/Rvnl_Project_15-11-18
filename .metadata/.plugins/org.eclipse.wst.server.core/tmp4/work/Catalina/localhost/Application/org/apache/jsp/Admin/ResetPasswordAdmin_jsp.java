/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.86
 * Generated at: 2018-05-29 05:02:15 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.Admin;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.net.HttpURLConnection;
import javax.servlet.*;
import javax.servlet.http.*;
import java.util.*;
import javax.naming.*;
import java.sql.*;
import javax.sql.*;
import javax.servlet.*;
import java.util.*;
import javax.servlet.http.*;
import javax.naming.*;
import java.sql.*;
import javax.sql.*;
import java.security.*;
import javax.crypto.*;
import javax.mail.*;
import javax.mail.internet.*;
import java.net.URL.*;
import java.io.*;
import java.net.URLEncoder.*;
import java.net.URLConnection.*;
import java.io.InputStreamReader.*;
import java.io.OutputStreamWriter.*;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.*;
import javax.naming.*;
import java.sql.*;
import javax.sql.*;
import org.apache.taglibs.standard.tag.common.sql.ResultImpl;

public final class ResetPasswordAdmin_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(4);
    _jspx_dependants.put("/Admin/included/NewHeader1.jsp", Long.valueOf(1526644595896L));
    _jspx_dependants.put("/WEB-INF/sessionCheck1.jspf", Long.valueOf(1524567358000L));
    _jspx_dependants.put("/Admin/included/Newfooter.jsp", Long.valueOf(1526628672412L));
    _jspx_dependants.put("/Admin/sessionCheck.jsp", Long.valueOf(1524567356000L));
  }

  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fif_0026_005ftest;

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
    _005fjspx_005ftagPool_005fc_005fif_0026_005ftest = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
  }

  public void _jspDestroy() {
    _005fjspx_005ftagPool_005fc_005fif_0026_005ftest.release();
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=ISO-8859-1");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 1120256, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

 
int timeout = session.getMaxInactiveInterval();
response.setHeader("Refresh", timeout + "; URL = admn_login.jsp");

      out.write("\r\n");
      out.write("\r\n");
      out.write(" ");
      out.write("<!DOCTYPE html>\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\" />\r\n");
      out.write("<meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\r\n");
      out.write("<link rel=\"stylesheet\" href=\"/Application/Admin/resources/bootstrap-3.3.7-dist/css1/bootstrap.css\"/>\r\n");
      out.write("<link rel=\"stylesheet\" href=\"/Application/Admin/resources/bootstrap-3.3.7-dist/css1/bootstrap-theme.css\"/> \r\n");
      out.write("<link rel=\"stylesheet\" href=\"/Application/Admin/resources/css/main.css\"/>\t\r\n");
      out.write("\t\t");

 String theme3 = (String) pageContext.getAttribute("myTheme", PageContext.SESSION_SCOPE);
		System.out.println("Theme="+theme3);
 
      out.write("\r\n");
      out.write("\t\t\r\n");
      out.write("<meta charset=\"ISO-8859-1\">\r\n");
      out.write("<title>PDAMS</title>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<style>\r\n");
      out.write(".white-marquee {\r\n");
      out.write("   font-family: arial, calibri, \"Times New Roman\", Times, serif;\r\n");
      out.write("\tfont-size: 16px;\r\n");
      out.write("\tcolor: white;// blue;//white;\r\n");
      out.write("\t//margin-left:50px;\r\n");
      out.write("\tfont-weight:bold;\r\n");
      out.write("\tpadding:5px;\r\n");
      out.write("\tpadding-bottom:5px;\r\n");
      out.write("}\r\n");
      out.write(".marquee_section {\r\n");
      out.write("\twidth: 73%;\r\n");
      out.write("\tfloat: right;\r\n");
      out.write("\tline-height: 64px;\r\n");
      out.write("\theight: 65px;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("</style>\r\n");
      out.write("\r\n");
      out.write("</head>\r\n");
      out.write("<body>   \r\n");

//String mailstatus=(String)session.getAttribute("MailStatus"); 
//String user = (String) session.getAttribute("user_name");
String user_code = (String) session.getAttribute("User_Code");
if (user_code!=null) {} else {user_code="0";}
 String mq=null,  mqLaunch=null, mqMaint=null, mqOther=null, mqRly=null, mqRVNL=null;					
// System.out.println("code="+user_code);	
  Connection conn7 = null;
     			PreparedStatement ps777=null;
     			ResultSet  rs777=null;
     						//Statement stmt7 = null;
     						try {
     							Context initCtx = new InitialContext();
     							Context envCtx = (Context) initCtx.lookup("java:comp/env");
     							DataSource ds = (DataSource) envCtx.lookup("jdbc/MySQLDB");

     							conn7 = ds.getConnection();
     							String sql35 = "select item, description from xx_maintenance";
     									
    								ps777 = conn7.prepareStatement(sql35);
    								rs777 = ps777.executeQuery();
    								while (rs777.next()) {
    									String item=rs777.getString(1);
    									 String desc=rs777.getString(2);
    									if (item.equalsIgnoreCase("marquee-launch")) {
    										mqLaunch=desc;
    									} else if (item.equalsIgnoreCase("marquee-maint")) {
    										mqMaint=desc;
    									} else if (item.equalsIgnoreCase("marquee-other")) {
    										mqOther=desc;
    									} else if (item.equalsIgnoreCase("marquee-Rly")) {
    										mqRly=desc;
    									} else if (item.equalsIgnoreCase("marquee-RVNL")) {
    										mqRVNL=desc;
    									} 
    								}
    								if (user_code.equalsIgnoreCase("2")) {
    									mq= mqLaunch+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+mqMaint+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+mqOther+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+mqRly;
    								} else if (user_code.equalsIgnoreCase("5")) {
    									mq= mqLaunch+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+mqMaint+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+mqOther+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+mqRVNL;
    								} else {
    								mq= mqLaunch+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+mqMaint+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+mqOther;
    								} 		 
    								//System.out.println("marquee="+mq);			
     						}catch(Exception e){
    							
    							e.printStackTrace();
    						} finally {
    						    try { rs777.close(); } catch (Exception e) { /* ignored */ }
    						    try { ps777.close(); } catch (Exception e) { /* ignored */ }
    						    try { conn7.close(); } catch (Exception e) { /* ignored */ }
    						}


      out.write("\r\n");
      out.write("  <input type=\"hidden\" id=\"menu1\" value='");
      out.print(session.getAttribute("user_name") );
      out.write("'> \r\n");
      out.write("  <!-- header -->\r\n");
      out.write("     \t   <div class=\"container-fluid top_bar\">\r\n");
      out.write("           <div class=\"row\">\r\n");
      out.write("           <div class=\"col-md-4 col-sm-4 col-xs-4\" >\r\n");
      out.write("           <img src=\"/Application/Admin/images/Rail_logo.png\" alt=\"\" class=\"img-responsive\"/>\r\n");
      out.write("           </div>\r\n");
      out.write("           <div class=\"col-md-4 col-sm-4 col-xs-4 top_middle_bar\">\r\n");
      out.write("           <h2 ><p class=\"text-white bg-dark\"><i>Project Documents Approval Monitoring System (PDAMS)</i></p></h2>\r\n");
      out.write("           </div>\r\n");
      out.write("           <div class=\"col-md-4 col-sm-4 col-xs-4 right_bar\" >\r\n");
      out.write("           <img src=\"/Application/Admin/images/RVNL_LOGO.jpg\" alt=\"\" class=\"img-responsive pull-right\"/>\r\n");
      out.write("           </div>\r\n");
      out.write(" \t\t   \r\n");
      out.write(" \t\t  \r\n");
      out.write("   \r\n");
      out.write(" \t\t \r\n");
      out.write("   \r\n");
      out.write("   </div>\r\n");
      out.write("   </div>\r\n");
      out.write("   <!-- end of header -->\r\n");
      out.write("\t   <div class=\"topmenu\" id=\"menu\">\r\n");
      out.write("\t  <div id=\"menu1\"  style=\"float:left;\"> \r\n");
      out.write("\t  \t\t<ul>\r\n");
      out.write("\t  \t\t\r\n");
      out.write("\t  \t\t<!-- <li><a href=\"user_index.jsp\">Add/Modify Docs</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"user_Project.jsp\">My Projects</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"Reportpiuinitiate.jsp\">My Reports</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"MoreInfo.jsp\">Returned Tasks</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"PullBack.jsp\">PullBack Doc</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"FinalApproval.jsp\">Docs under Approval</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"FinallyApprovedShow.jsp\">Approved Docs</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"ManualMail.jsp\">Reminders</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"User_List.jsp\">User List</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"changepasswordlocaladmin.jsp\">Change Password</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"helpmain.jsp\">Help</a></li>\r\n");
      out.write("\t   \t\t\t\t\t<li><a href=\"admn_logout.jsp\">Logout</a></li>  \r\n");
      out.write("\t   \t\t\t\t\t\t<li><a href=\"NewIndex.jsp\">Home</a></li> -->\r\n");
      out.write("\t   \t\t\t\t\t\r\n");
      out.write("\t   \t\t\t\t\t</ul>\t \r\n");
      out.write("\t   \t\t\t\t\t</div>  \t\r\n");
      out.write("\t   \t\t\t\t\t");

	   					if (!mq.equalsIgnoreCase("") && mq!=null) {       
	   					
      out.write("\t\t\t\t\r\n");
      out.write("\t   <div id=\"menu2\"  style=\"width:100%; float:right;\">     \t\t\t\t\t\r\n");
      out.write("\t   <marquee><span class=\"white-marquee\" id=\"white-marquee\" style=\"float:left;\">");
      out.print(mq );
      out.write("</span></marquee>  </div>\r\n");
      out.write("\t");

	}
	
      out.write("\t\r\n");
      out.write("\t</div> \r\n");
      out.write("\t<script type=\"text/javascript\" src=\"/Application/Admin/resources/bootstrap-3.3.7-dist/js/jquery-3.3.1.js\"></script> \r\n");
      out.write("   <script type=\"text/javascript\" src=\"/Application/Admin/resources/bootstrap-3.3.7-dist/js/bootstrap.js\"></script>  \t\t\t\t\t\r\n");
      out.write("</body>\r\n");
      out.write("</html>");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
 

int timeout1 = session.getMaxInactiveInterval();
response.setHeader("Refresh", timeout1 + "; URL = admn_login.jsp");

if(((String)session.getAttribute("user_name"))==null)
       {
           
	response.sendRedirect("admn_login.jsp");
           
       }
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\r\n");
      out.write("<script src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\"></script>\r\n");
      out.write("    <script src=\"http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js\"></script>\r\n");
      out.write("    \r\n");
      out.write("    <script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"https://code.jquery.com/jquery-1.12.4.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"https://code.jquery.com/ui/1.12.1/jquery-ui.js\"></script>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<script src=\"resources/JS/Approval_wf230.js\"></script>\r\n");
      out.write("\r\n");
      out.write("    <script src=\"resources/JS/validateSysAdmin230.js\"></script>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js\"></script>\r\n");
      out.write("<script\r\n");
      out.write("\tsrc=\"http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/jquery-ui.js\"\r\n");
      out.write("\ttype=\"text/javascript\"></script>\r\n");
      out.write("\r\n");
      out.write("<link\r\n");
      out.write("\thref=\"http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/themes/blitzer/jquery-ui.css\"\r\n");
      out.write("\trel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("\r\n");
      out.write("<link href=\"resources/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\r\n");
      out.write("<link rel=\"stylesheet\"\r\n");
      out.write("\thref=\"//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css\">\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n");
      out.write("\r\n");
      out.write("<title>Insert title here</title>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\r\n");
      out.write("function checkPasswordMatch() {\r\n");
      out.write("\tvar password = $(\"#password1\").val();\r\n");
      out.write("\tvar confirmPassword = $(\"#password2\").val();\r\n");
      out.write("\t\r\n");
      out.write("\tif(password.length >= 5 && confirmPassword.length >= 5) {\r\n");
      out.write("\t\tif (password != confirmPassword) {\r\n");
      out.write("\t\t\t$(\"#divCheckPasswordMatch\").html(\"Passwords do not match!\");\r\n");
      out.write("\t\t\t$(\"#divCheckPasswordMatch\").css(\"color\", \"red\");\r\n");
      out.write("\t\t\t $('button[type=\"button\"]').prop('disabled', true);\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\t$(\"#divCheckPasswordMatch\").html(\"Passwords match.\");\r\n");
      out.write("\t\t\t$(\"#divCheckPasswordMatch\").css(\"color\", \"green\");\r\n");
      out.write("\t\t\t $('button[type=\"button\"]').prop('disabled', false);\r\n");
      out.write("\t\t}\r\n");
      out.write("    } else {\r\n");
      out.write("       //alert(\"Please Provide password of atleast 5 chars.\");\r\n");
      out.write("       //$('button[type=\"button\"]').prop('disabled', false);\r\n");
      out.write("       document.getElementById(\"submit2\").disabled = true;\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("\t\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("</script>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("    function refreshAndClose() {\r\n");
      out.write("      //  window.opener.location.reload(true);\r\n");
      out.write("        window.close();\r\n");
      out.write("    }\r\n");
      out.write("</script>\r\n");
      out.write("<style>\r\n");
      out.write("  input[type=text], select {\r\n");
      out.write("    width: 100%;\r\n");
      out.write("    padding: 12px 20px;\r\n");
      out.write("    margin: 8px 0;\r\n");
      out.write("    display: inline-block;\r\n");
      out.write("    border: 1px solid #ccc;\r\n");
      out.write("    border-radius: 4px;\r\n");
      out.write("    box-sizing: border-box;\r\n");
      out.write("}\r\n");
      out.write("    div.absolute {\r\n");
      out.write("   \tposition:absolute;\r\n");
      out.write("   \tmargin-top: 5px;\r\n");
      out.write("   \tmargin-left: 13px;\r\n");
      out.write("   \tmargin-bottom: 20px;\r\n");
      out.write(" \tpadding: 15 px;\r\n");
      out.write("    width: auto;\r\n");
      out.write("    height: 30px;\r\n");
      out.write("    border: 3px double #ff4d4d;\r\n");
      out.write("    background-color:#ffe6e6;\r\n");
      out.write("        }\r\n");
      out.write("    table.center {\r\n");
      out.write("    margin-left:auto; \r\n");
      out.write("    margin-right:auto;\r\n");
      out.write("  }\r\n");
      out.write("  .td{\r\n");
      out.write(" margin-left: 35%;\r\n");
      out.write("margin-top: 40px;\r\n");
      out.write("  }\r\n");
      out.write("</style>\r\n");
      out.write("</head>\r\n");
      out.write("<body>\r\n");

String username =request.getParameter("usern");
System.out.println("mmmm"+username);
//String username=username1.replace('~','/'); 
String role1=(String)session.getAttribute("role");
String role=(String)session.getAttribute("Type");
String zone_id1=(String)session.getAttribute("zone_id"); 
String piu_id1=(String)session.getAttribute("piu_id"); 
String div_id1=(String)session.getAttribute("Division_Id");
String user = (String) session.getAttribute("user_name");


      out.write(" \r\n");
      out.write("<div class=\"absolute\" style=\"font-weight:bold\" ><h8>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Change User Password] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h8>\r\n");
      out.write("\r\n");
      out.write("<h8><font style=\"color:red; font-weight:normal\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Welcome&nbsp;</font><font style=\"color:#3333cc; font-weight:normal\">:&nbsp;");
      out.print((String)session.getAttribute("user_name") );
      out.write("&nbsp;&nbsp;&nbsp;</font></h8>\r\n");
      out.write("</div>\r\n");
      out.write("<div class=\"container\" style=\"margin-left:0px; padding: 0px; width:1600px;\">\r\n");
      out.write("<br><br><br><br><br><br><br>\r\n");
      out.write("<form id='resetpassword' name='resetpassword' style=\"margin-top: 0px;\">\r\n");
      out.write("<INPUT TYPE=\"HIDDEN\" NAME=\"stage\" id=\"stage\">\r\n");
      out.write("<INPUT TYPE=\"HIDDEN\" NAME=\"usern1\" id=\"usern1\">\r\n");
      out.write("<INPUT TYPE=\"HIDDEN\" NAME=\"password\" id=\"password\">\r\n");
      //  c:if
      org.apache.taglibs.standard.tag.rt.core.IfTag _jspx_th_c_005fif_005f0 = (org.apache.taglibs.standard.tag.rt.core.IfTag) _005fjspx_005ftagPool_005fc_005fif_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.IfTag.class);
      boolean _jspx_th_c_005fif_005f0_reused = false;
      try {
        _jspx_th_c_005fif_005f0.setPageContext(_jspx_page_context);
        _jspx_th_c_005fif_005f0.setParent(null);
        // /Admin/ResetPasswordAdmin.jsp(156,0) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
        _jspx_th_c_005fif_005f0.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.stage == null }", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
        int _jspx_eval_c_005fif_005f0 = _jspx_th_c_005fif_005f0.doStartTag();
        if (_jspx_eval_c_005fif_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
          do {
            out.write("\r\n");
            out.write("\r\n");
            out.write("<div class=\"td\">\r\n");
            out.write("\t\t\tNew Password:<input type=\"password\" name=\"password1\" id=\"password1\"\r\n");
            out.write("\t\t\t\tstyle=\"width: 270px;margin: 0px 0px 0px 21px;\" onkeyup=\"checkPasswordMatch();\" required=\"true\"/>\r\n");
            out.write("\t\t\r\n");
            out.write("\t\t<div class=\"registrationFormAlert\" id=\"divCheckPasswordMatch\"\r\n");
            out.write("\t\t\tstyle=\"margin: 12px 0px 0px 114px; color: red;\"><br></div>\r\n");
            out.write("\t\t\t</div>\r\n");
            out.write("\t\t<div class=\"td\">\r\n");
            out.write("\t\t\tConfirm Password:<input type=\"password\" name=\"password2\"\r\n");
            out.write("\t\t\t\tid=\"password2\" onkeyup=\"checkPasswordMatch();\"\r\n");
            out.write("\t\t\t\tstyle=\"width: 270px\" required=\"true\" /></br> </br> </br>\r\n");
            out.write("\t\t\r\n");
            out.write("\t\t\t\t\r\n");
            out.write("\t\t<button type=\"button\" name=\"submit2\" id=\"submit2\"\r\n");
            out.write("\t\t\tclass=\"btn btn-primary\" onclick=\"actionresetpassword('");
            out.print(username);
            out.write("')\"\r\n");
            out.write("\t\t\tstyle=\"width: 150px;margin-left: 125px;\" font-size: inherit; margin: 14px -29px 0px 112px;\">Reset\r\n");
            out.write("\t\t\tPassword</button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type=\"reset\" class=\"btn btn-primary\" value=\"Cancel\" onClick=\"refreshAndClose()\" />\r\n");
            out.write("\r\n");
            out.write("<br><br> <br> <br>\r\n");
            out.write("<h4><span style=\"color:red; margin-left: -150px;\">Note* : </span>Password should be of minimum five length Mandatory !</h4>\r\n");
            out.write("\r\n");
            out.write("\r\n");
            out.write("<div id=\"dialogid\" style=\"display: none\"\r\n");
            out.write("\t\t\t\t\t\t\t\talign=\"center\">\r\n");
            out.write("\t\t\t\t\t\t\t\t<br> Please Fill Valid Details <br>\r\n");
            out.write("\t\t\t\t\t\t\t\t<br>\r\n");
            out.write("\t\t\t\t\t\t\t\t<button id=\"cancle\" class=\"btn btn-primary\"\r\n");
            out.write("\t\t\t\t\t\t\t\t\tonclick=\"$('#dialogid').dialog('close');\">cancel</button>\r\n");
            out.write("\t\t\t\t\t\t\t</div>\r\n");
            int evalDoAfterBody = _jspx_th_c_005fif_005f0.doAfterBody();
            if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
              break;
          } while (true);
        }
        if (_jspx_th_c_005fif_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
          return;
        }
        _005fjspx_005ftagPool_005fc_005fif_0026_005ftest.reuse(_jspx_th_c_005fif_005f0);
        _jspx_th_c_005fif_005f0_reused = true;
      } finally {
        org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_c_005fif_005f0, _jsp_getInstanceManager(), _jspx_th_c_005fif_005f0_reused);
      }
      out.write('\r');
      out.write('\n');
      //  c:if
      org.apache.taglibs.standard.tag.rt.core.IfTag _jspx_th_c_005fif_005f1 = (org.apache.taglibs.standard.tag.rt.core.IfTag) _005fjspx_005ftagPool_005fc_005fif_0026_005ftest.get(org.apache.taglibs.standard.tag.rt.core.IfTag.class);
      boolean _jspx_th_c_005fif_005f1_reused = false;
      try {
        _jspx_th_c_005fif_005f1.setPageContext(_jspx_page_context);
        _jspx_th_c_005fif_005f1.setParent(null);
        // /Admin/ResetPasswordAdmin.jsp(188,0) name = test type = boolean reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
        _jspx_th_c_005fif_005f1.setTest(((java.lang.Boolean) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.stage != null }", java.lang.Boolean.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false)).booleanValue());
        int _jspx_eval_c_005fif_005f1 = _jspx_th_c_005fif_005f1.doStartTag();
        if (_jspx_eval_c_005fif_005f1 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
          do {
            out.write('\r');
            out.write('\n');

String prof_alert2=(String)session.getAttribute("Profile_Alert");
String username2 =request.getParameter("usern1");
String password =request.getParameter("password");
String pwds=password;
//encryption code starts here
MessageDigest mdAlgorithm = MessageDigest.getInstance("MD5");
mdAlgorithm.update(password.getBytes());

byte[] digest = mdAlgorithm.digest();
StringBuffer hexString = new StringBuffer();

for (int i = 0; i < digest.length; i++) {
	password = Integer.toHexString(0xFF & digest[i]);

 if (password.length() < 2) {
 	password = "0" + password;
 }

 hexString.append(password);
}



//encrytion md5 ends here

String usern=username2.replaceAll("~", "/");

Connection con= null;

PreparedStatement ps = null, ps1 =null, ps9=null;
ResultSet rs = null,rs1=null, rs9=null;
Statement st = null;
String oldpass="", email_id=null, contact_no=null;
String msg="";

try{
	
	Context initCtx = new InitialContext();
	Context envCtx = (Context) initCtx.lookup("java:comp/env");
	DataSource ds = (DataSource) envCtx.lookup("jdbc/MySQLDB");

	 con = ds.getConnection();
st = con.createStatement();
int i = st.executeUpdate("update xx_user_master set Password='"+ password + "' where User_name='"+ usern + "'");
 msg="Password changed successfully" ;
 String usersql = "select * from xx_user_master where User_name='"+usern+"'";
	ps9 = con.prepareStatement(usersql);
	rs9 = ps9.executeQuery();
	while(rs9.next()){
	 email_id=rs9.getString("Email_Id");
	 contact_no=rs9.getString("Contact_No");
	}
rs9.close();
ps9.close();
st.close();
con.close();
if (prof_alert2.equalsIgnoreCase("On")) {
// Mail code starts from here
//System.out.println("today:"+Date1+"approval date:"+date);			
		 String result, cc1;
		 	cc1="";
		    // Get recipient's email-ID, message & subject-line from index.html page
		    StringBuffer url =    request.getRequestURL();
			String pageName1 = url.substring(0, url.lastIndexOf("/"))+"/admn_login.jsp";
		    final String to = email_id;
		    final String subject = "RVNL DOCUMENT PORTAL - password reset";
		    final String messg = "<div style='font-family:Georgia; font-size:16px; text-align:justify; line-height:150%;'>To <BR> <b>"+usern.toUpperCase()+" </b><br><br> Your login password has been reset as under;"
		     +"<br><BR> User Id:  "+usern+"<br> Password: "+pwds+"<BR> Login webpage: <a href=\""+ pageName1+"\">"+pageName1+"</a><br><br>You are advised to change your password. <br><br><br><span style='color:brown; font-size:20px; font-style:italic;'<b> RVNL Document Portal</b></span><br><br><span style='color:gray;  font-size:10px; font-style:italic;'>Note: This is a system generated email. Don't reply to system email address i.e. indiarvnl@gmail.com.</span></div>";
		    						
		    // Sender's email ID and password needs to be mentioned
		    final String from = "indiarvnl@gmail.com";
		    final String pass = "vsam3WSCJAIw4cj7";
		    
		    final String cc = cc1;
		    // Defining the gmail host
		    String host = "smtp-relay.sendinblue.com";
		 
		    // Creating Properties object
		    Properties props = new Properties();
		 
		    // Defining properties
		   
		    props.put("mail.smtp.starttls.enable", "true");
		    props.put("mail.smtp.host", host);
		    props.put("mail.smtp.user", from);
		    props.put("mail.smtp.password", pass);
		    props.put("mail.smtp.port", "587");
		    props.put("mail.smtp.auth", "true");
		 
		    // Authorized the Session object.
		    Session mailSession = Session.getInstance(props, new javax.mail.Authenticator() {
		        @Override
		        protected PasswordAuthentication getPasswordAuthentication() {
		            return new PasswordAuthentication(from, pass);
		        }
		    });
		 
		    try {
		        // Create a default MimeMessage object.
		        MimeMessage message = new MimeMessage(mailSession);
		        // Set From: header field of the header.
		        message.setFrom(new InternetAddress(from));
		        // Set To: header field of the header.
		        message.addRecipient(Message.RecipientType.TO,
		                new InternetAddress(to));
		        message.setRecipients(Message.RecipientType.CC, cc);
		        // Set Subject: header field
		        message.setSubject(subject);
		        // Now set the actual message
		        message.setText(messg);
		        // Send message
		        Transport.send(message);
		        result = "Your mail sent successfully....";
		        System.out.println("Email sent successfully");
		    } catch (MessagingException mex) {
		        mex.printStackTrace();
		        result = "Error: unable to send mail....";
		    }
		 
		    // mail code ends here
		     //SMS code 

try {
//Construct data
//contact number supervisor------contact_No_sup
//contact number sender ------------- supcontact

String usersms = "username=" + "indiarvnl@gmail.com";
String hash = "&hash=" + "60b97ac840106a43c5a0e44fb778276d90330ece5e2da9ad534868c03137636d";
//String apiKey = "apikey=" + "noVebn4XbP0-UFyeK1rRwkvCNdDw5ZXfVqrSNPndk2";
String message = "&message=" + "Your login password has been reset. Please check your email ("+email_id+") for new password.\n\nRVNL Document Portal";
String sender = "&sender=" + "RPDAMS";
String numbers = "&numbers=" + ""+contact_no+"";

//Send data
HttpURLConnection connsms = (HttpURLConnection) new java.net.URL("http://api.textlocal.in/send in/?").openConnection();

String data = usersms + hash + numbers + message + sender;
//String data = apiKey + numbers + message + sender;
connsms.setDoOutput(true);
connsms.setRequestMethod("POST");
connsms.setRequestProperty("Content-Length", Integer.toString(data.length()));
connsms.getOutputStream().write(data.getBytes("UTF-8"));
final BufferedReader rd = new BufferedReader(new InputStreamReader(connsms.getInputStream()));
final StringBuffer stringBuffer = new StringBuffer();
String line;
while ((line = rd.readLine()) != null) {
stringBuffer.append(line);
}
rd.close();
System.out.println("Message sent successfully");
//return stringBuffer.toString();
} catch (Exception e) {
System.out.println("Error SMS "+e);
//return "Error "+e;
}					   
//sms code ends here
}

}catch(Exception e){
	e.printStackTrace();
} finally {
    try { con.close(); } catch (Exception e) { /* ignored */ }
}

            out.write("\r\n");
            out.write(" <div style='vertical-align: baseline; padding: 10px; margin: 20px; width:400px;' >\r\n");
            out.write("\t <div class=\"alert alert-success\">\r\n");
            out.write("\t <strong>Success!</strong> Password Updated Successfully!.\r\n");
            out.write("\t <br>\r\n");
            out.write("\t <br>\r\n");
            out.write("\t <center><input class='btn btn-primary' value='ok'  onClick=\"refreshAndClose()\" type='button'/></center>\r\n");
            out.write("\t\r\n");
            out.write("\t\t\r\n");
            out.write("\t </div>\r\n");
            out.write("</div>\r\n");
            int evalDoAfterBody = _jspx_th_c_005fif_005f1.doAfterBody();
            if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
              break;
          } while (true);
        }
        if (_jspx_th_c_005fif_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
          return;
        }
        _005fjspx_005ftagPool_005fc_005fif_0026_005ftest.reuse(_jspx_th_c_005fif_005f1);
        _jspx_th_c_005fif_005f1_reused = true;
      } finally {
        org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_c_005fif_005f1, _jsp_getInstanceManager(), _jspx_th_c_005fif_005f1_reused);
      }
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("</form><br><br>\r\n");
      out.write("<br><br><br><br><br><br>\r\n");
      out.write("</div>\r\n");
      out.write("\r\n");
      out.write("<!DOCTYPE html>\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\r\n");
      out.write("<link rel=\"stylesheet\" href=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\">\r\n");
      out.write("<title>Insert title here</title>\r\n");
      out.write("<style>\r\n");
      out.write("@import url('http://fonts.googleapis.com/css?family=Open+Sans:400,700');\r\n");
      out.write("\r\n");
      out.write("footer{\r\n");
      out.write("\tposition: fixed;\r\n");
      out.write("\tmargin-top:150px;\r\n");
      out.write("\tbottom: 0;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("</style>\r\n");
      out.write("</head>\r\n");
      out.write("<body>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<!-- \r\n");
      out.write("<footer>\r\n");
      out.write("<div class=\"city\">\r\n");
      out.write("  <ul class=\" nav navbar-nav\">\r\n");
      out.write("  \r\n");
      out.write("    <li class=\"footerli\">Rail Vikas Nigam Limited.</li>\r\n");
      out.write("    </ul>\r\n");
      out.write("    <ul   class=\"nav navabar-nav\" style=\"float:right;\">\r\n");
      out.write("   <li class=\"footerli\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Design & Developed By<a href=\"http://www.awcsoftware.net\" style=\"text-decoration:none;\">AWC SOFTWARE PVT LTD</a></li>\r\n");
      out.write("    \r\n");
      out.write("  </ul>\r\n");
      out.write(" </div>\r\n");
      out.write("\r\n");
      out.write("</footer> -->\r\n");
      out.write("\r\n");
      out.write("<footer class=\"footer-basic-centered\">\r\n");
      out.write("\r\n");
      out.write("\t\t\t<p class=\"footer-company-motto\" style=\"float:left;\">Rail Vikas Nigam Limited</p>\r\n");
      out.write("\t\t\t<p class=\"footer-company-motto\" style=\"float:center; font-family:serif; font-size:14px; font-style:italic; margin-top:5px;\">Ver:2.30.pks</p>\r\n");
      out.write("\t\t\t<p class=\"footer-company-name\" style=\"float:right; margin-top:-20px;\"> Design & Developed By<a href=\"http://www.awcsoftware.net\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AWC SOFTWARE PVT LTD</a></p>\r\n");
      out.write("\r\n");
      out.write("\t\t</footer>\r\n");
      out.write("</body>");
      out.write("\r\n");
      out.write("</body><br><br>\r\n");
      out.write("   \r\n");
      out.write("</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
