/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.86
 * Generated at: 2018-05-03 09:35:54 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.Admin;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import javax.naming.*;
import java.sql.*;
import javax.sql.*;
import java.io.FileOutputStream;
import javax.servlet.*;
import javax.servlet.http.*;
import java.util.*;
import javax.naming.*;
import java.sql.*;
import javax.sql.*;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.Element;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.pdf.BaseFont;
import com.itextpdf.text.BaseColor;
import com.itextpdf.text.Font;
import java.awt.Color;
import com.itextpdf.text.pdf.PdfWriter;
import com.itextpdf.text.Document;
import com.itextpdf.text.Chunk;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.text.DateFormat;
import java.net.URLEncoder;
import org.joda.time.DateTime;
import org.joda.time.Days;
import org.joda.time.Hours;
import org.joda.time.Minutes;
import org.joda.time.Seconds;

public final class PublicProjectReport_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);
    _jspx_dependants.put("/WEB-INF/sessionCheck1.jspf", Long.valueOf(1524567358000L));
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=ISO-8859-1");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 1120256, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

 
int timeout = session.getMaxInactiveInterval();
response.setHeader("Refresh", timeout + "; URL = admn_login.jsp");

      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("<title>PDAMS - Report</title>\r\n");
      out.write("<style>\r\n");
      out.write(".dt-button.buttons-copy.buttons-html5 {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write(".dt-button.buttons-csv.buttons-html5 {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write(".dt-button.buttons-pdf.buttons-html5 {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write("#example_length {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write("#example {\r\n");
      out.write("    width: inherit;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("table {\r\n");
      out.write("\tmso-displayed-decimal-separator: \"\\.\";\r\n");
      out.write("\tmso-displayed-thousand-separator: \"\\,\";\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("@page {\r\n");
      out.write("\tmargin: 1.0in .75in 1.0in .75in;\r\n");
      out.write("\tmso-header-margin: .5in;\r\n");
      out.write("\tmso-footer-margin: .5in;\r\n");
      out.write("\tmso-page-orientation: landscape;\r\n");
      out.write("}\r\n");
      out.write("</style>\r\n");
      out.write("\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.css\" rel=\"stylesheet\" />\r\n");
      out.write("<!-- <title>PIU Level Report</title> -->\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<script src=\"resources/JS/validateSysAdmin230.js\"></script>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"https://code.jquery.com/jquery-1.12.4.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"https://code.jquery.com/ui/1.12.1/jquery-ui.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"http://www.allmyscripts.com/Table_Sort/beta/gs_sortable.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" language=\"javascript\" \r\n");
      out.write("\r\n");
      out.write("src=\"js/data_table/jquery.dataTables.min.js\"></script>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js\"></script>\r\n");
      out.write("<script\r\n");
      out.write("\tsrc=\"http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/jquery-ui.js\"\r\n");
      out.write("\ttype=\"text/javascript\"></script>\r\n");
      out.write("<script src=\"resources/JS/Approval_wf230.js\"></script>\r\n");
      out.write("<link\r\n");
      out.write("\thref=\"http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/themes/blitzer/jquery-ui.css\"\r\n");
      out.write("\trel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("\r\n");
      out.write("<link href=\"resources/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\r\n");
      out.write("<link rel=\"stylesheet\"\r\n");
      out.write("\thref=\"//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css\">\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.css\" rel=\"stylesheet\" />\r\n");
      out.write("<script src=\"resources/JS/backButton.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/validate230.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/PIU_depend230.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"resources/JS/datasort.js\"></script>\r\n");
      out.write("\t<link\r\n");
      out.write("\thref=\"https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css\"\r\n");
      out.write("\trel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("\t\r\n");
      out.write("<link href=\"resources/css/buttons.dataTables.min.css\" rel=\"stylesheet\" type=\"text/css\">\r\n");
      out.write("<script src=\"resources/JS/jquery-1.12.4.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/jquery.dataTables.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/dataTables.buttons.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/buttons.flash.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/jszip.min.js\"></script>\r\n");
      out.write("<!-- <script src=\"resources/JS/pdfmake.min.js\"></script> -->\r\n");
      out.write("<script src=\"resources/JS/vfs_fonts.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/buttons.print.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/buttons.html5.min.js\"></script>\r\n");
      out.write("<script>\r\n");
      out.write("function myFunction() {\r\n");
      out.write("    window.print();\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("function closeMe()\r\n");
      out.write("{\r\n");
      out.write("var win = window.open(\"\",\"_self\"); \r\n");
      out.write("win.close();\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("function mywinClose() {\r\n");
      out.write("\tvar sessionTimeout1 = \"");
      out.print( session.getMaxInactiveInterval() );
      out.write("\";\r\n");
      out.write("\tsetTimeout(function(){var parent1=window.open(\"\",\"report_master\"); parent1.close(); },(sessionTimeout1-10)*1000);\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("\r\n");
      out.write("\t<script>\r\n");
      out.write("\t$(document).ready(function() {\r\n");
      out.write("\t\tvar nc1=3;\r\n");
      out.write("\t\tvar message1=document.getElementById(\"message1\").value;\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar piu1=document.getElementById(\"piu1\");\r\n");
      out.write("\t\tif(piu1==null){\r\n");
      out.write("\t\t\tpiu1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tpiu1=document.getElementById(\"piu1\").value;\r\n");
      out.write("\t\t\tpiu1=\"PIU :\"+piu1; nc1--;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar project1=document.getElementById(\"project1\");\r\n");
      out.write("\t\tif(project1==null){\r\n");
      out.write("\t\t\tproject1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tproject1=document.getElementById(\"project1\").value;\r\n");
      out.write("\t\t\tproject1=\"Project :\"+project1; nc1--;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar docType1=document.getElementById(\"docType1\");\r\n");
      out.write("\t\tif(docType1==null){\r\n");
      out.write("\t\t\tdocType1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar docType1=document.getElementById(\"docType1\").value;\r\n");
      out.write("\t\t\tdocType1=\"Document Name :\"+docType1; nc1--;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar pkl1=piu1+\"              \"+project1;\r\n");
      out.write("\t    var pkl2=docType1+\"               \";\r\n");
      out.write("\r\n");
      out.write("\t\r\n");
      out.write("\t    \r\n");
      out.write("\t   \t\t$('#example').DataTable( {\r\n");
      out.write("\t   \t\t\t\t\"infoCallback\": function( settings, start, end, max, total, pre ) {\r\n");
      out.write("\t\t\t\t\tif (max==total) { return \"Showing \" + (end-start+1) + \"  of \" +total+\" records\"}\r\n");
      out.write("\t\t\t\t\telse {return \"Showing \" + (end-start+1) + \"  of \" +total+\" records (filtered from total \" + max+\" records)\"}\r\n");
      out.write("\t\t\t\t   \t}, \r\n");
      out.write("\t\t\t\t \t\t\t   \r\n");
      out.write("\t\t        dom: 'Bfrtip',\r\n");
      out.write("\t\t        lengthMenu: [\r\n");
      out.write("\t\t                     [ 10, 25, 50, -1 ],\r\n");
      out.write("\t\t                     [ '10 rows', '25 rows', '50 rows', 'Show all' ]\r\n");
      out.write("\t\t                 ],\r\n");
      out.write("\t\t                 \r\n");
      out.write("\t\t        buttons: [\r\n");
      out.write("\t'pageLength',\r\n");
      out.write("\t\t                  \r\n");
      out.write("\t{exportOptions: {\r\n");
      out.write("\t\t  \r\n");
      out.write("\t//columns: [':visible :not(21)']\r\n");
      out.write("\t},\r\n");
      out.write("\t    extend: 'print',\r\n");
      out.write("\t    header:true,\r\n");
      out.write("\t    footer:true,\r\n");
      out.write("\t    message: message1,\r\n");
      out.write("\t    title: 'RVNL PROJECT DOCUMENT STATUS REPORT',\r\n");
      out.write("\t    customize: function (win) {\r\n");
      out.write("  \t        $(win.document.body).find('table').addClass('display').css('font-size', '9px');\r\n");
      out.write("\t        $(win.document.body).find('tr:nth-child(odd) td').each(function(index){\r\n");
      out.write("\t            $(this).css('background-color','#D0D0D0');\r\n");
      out.write("\t        });\r\n");
      out.write("\t        $(win.document.body).find('h1').css('text-align','center');\r\n");
      out.write("\t        var footer = $('tfoot');\r\n");
      out.write("     \t    if (footer.length > 0) {\r\n");
      out.write("     \t        var exportFooter = $(win.document.body).find('tfoot:eq(0)');\r\n");
      out.write("     \t        exportFooter.after(footer.clone());\r\n");
      out.write("     \t        exportFooter.remove();\r\n");
      out.write("     \t    }\r\n");
      out.write("     \t \r\n");
      out.write("  \t    }\r\n");
      out.write("\t},\r\n");
      out.write("\r\n");
      out.write("\t\t                  \r\n");
      out.write("\t{exportOptions: {\r\n");
      out.write("\t//   columns: [':visible :not(21)']\r\n");
      out.write("\t}, \r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t\t                  \r\n");
      out.write("\t\t\t                  //'print',\r\n");
      out.write("\t\t\t                  \r\n");
      out.write("\t\t\t                 title: 'RVNL PROJECT DOCUMENT STATUS REPORT',\r\n");
      out.write("\t\t\t                  extend: 'excel',\r\n");
      out.write("\t\t\t                  footer:true,\r\n");
      out.write("\t\t\t                 \r\n");
      out.write("\t\t\t                  fixedHeader: {\r\n");
      out.write("\t\t\t                      header: true,\r\n");
      out.write("\t\t\t                      footer: true\r\n");
      out.write("\t\t\t                  },\r\n");
      out.write("\t\t\t                  \r\n");
      out.write("\t\t\t               \r\n");
      out.write("\t\t\t                  customize: function (xlsx) {\r\n");
      out.write("\t\t\t                      var sheet = xlsx.xl.worksheets['sheet1.xml'];\r\n");
      out.write("\t\t\t                      var numrows = 4;\r\n");
      out.write("\t\t\t                      var clR = $('row', sheet);\r\n");
      out.write("\r\n");
      out.write("\t\t\t                      //update Row\r\n");
      out.write("\t\t\t                      clR.each(function () {\r\n");
      out.write("\t\t\t                          var attr = $(this).attr('r');\r\n");
      out.write("\t\t\t                          var ind = parseInt(attr);\r\n");
      out.write("\t\t\t                          ind = ind + numrows;\r\n");
      out.write("\t\t\t                          $(this).attr(\"r\",ind);\r\n");
      out.write("\t\t\t                      });\r\n");
      out.write("\t\t\t                      var message33=document.getElementById(\"message1\").value;\r\n");
      out.write("\t\t\t                      // Create row before data\r\n");
      out.write("\t\t\t                      $('row c ', sheet).each(function () {\r\n");
      out.write("\t\t\t                          var attr = $(this).attr('r');\r\n");
      out.write("\t\t\t                          var pre = attr.substring(0, 1);\r\n");
      out.write("\t\t\t                          var ind = parseInt(attr.substring(1, attr.length));\r\n");
      out.write("\t\t\t                          ind = ind + numrows;\r\n");
      out.write("\t\t\t                          $(this).attr(\"r\", pre + ind);\r\n");
      out.write("\t\t\t                      });\r\n");
      out.write("\t\t\t                       function Addrow(index,data) {\r\n");
      out.write("\t\t\t                          msg='<row r=\"'+index+'\">'\r\n");
      out.write("\t\t\t                          for(i=0;i<data.length;i++){\r\n");
      out.write("\t\t\t                              var key=data[i].key;\r\n");
      out.write("\t\t\t                              var value=data[i].value;\r\n");
      out.write("\t\t\t                              msg += '<c t=\"inlineStr\" r=\"' + key + index + '\">';\r\n");
      out.write("\t\t\t                              msg += '<is>';\r\n");
      out.write("\t\t\t                              msg +=  '<t>'+value+'</t>';\r\n");
      out.write("\t\t\t                              msg+=  '</is>';\r\n");
      out.write("\t\t\t                              msg+='</c>';\r\n");
      out.write("\t\t\t                          }\r\n");
      out.write("\t\t\t                          msg += '</row>';\r\n");
      out.write("\t\t\t                          return msg;\r\n");
      out.write("\t\t\t                      }\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t\t                      //insert\r\n");
      out.write("\t\t\t                       var r1 = Addrow(1, [{ key: 'F', value:  'RVNL DOCUMENT PORTAL' }]);\r\n");
      out.write("\t\t\t                      var r2 = Addrow(2, [{ key: 'A', value: pkl1 }]);\r\n");
      out.write("\t\t\t                       var r3 = Addrow(3, [{ key: 'A', value: pkl2 }]);\r\n");
      out.write("\t\t\t                     \r\n");
      out.write("\t\t\t                      sheet.childNodes[0].childNodes[1].innerHTML = r1+r2+r3+ sheet.childNodes[0].childNodes[1].innerHTML;\t\r\n");
      out.write("\t\t\t                  }\r\n");
      out.write("\t\t\t                  \r\n");
      out.write("\t\t\t\t\t\t}    \r\n");
      out.write("\t                ],\r\n");
      out.write("\t                \"footerCallback\": function ( tfoot, data, start, end, display ) {\r\n");
      out.write("\t  \t\t            var api = this.api(), data;\r\n");
      out.write("\t\t\t            // Remove the formatting to get integer data for summation\r\n");
      out.write("\t\t\t            var intVal = function ( i ) {\r\n");
      out.write("\t\t\t            \treturn typeof i === 'string' ?\r\n");
      out.write("\t\t\t            \t\t\t\ti.replace(/(<([^>]+)>)(\\-?)/ig, '')*1 :\r\n");
      out.write("\t\t\t                   typeof i === 'number' ?\r\n");
      out.write("\t\t\t                        i : 0;\r\n");
      out.write("\t\t\t            \t\r\n");
      out.write("\t\t\t            };\r\n");
      out.write("\t\t\t  var nc=nc1+1;\r\n");
      out.write("\t\t\t  var bc=nc1+1;\r\n");
      out.write("\t\t\t  var pageTotal=[];\r\n");
      out.write("\t\t\t  var total=[];\r\n");
      out.write("\t\t\t while (nc<bc+5) {\t\t            \r\n");
      out.write("\t\t\t\t // Total over all pages\r\n");
      out.write("\t\t\t            total[nc] = api\r\n");
      out.write("\t\t\t                .column(nc)\r\n");
      out.write("\t\t\t                .data()\r\n");
      out.write("\t\t\t                .reduce( function (a, b) {\r\n");
      out.write("\t\t\t                    return intVal(a) + intVal(b);\r\n");
      out.write("\t\t\t                    \r\n");
      out.write("\t\t\t                }, 0 );\r\n");
      out.write("\t\t\t \r\n");
      out.write("\t\t\t            // Total over this page\r\n");
      out.write("\t\t\t            pageTotal[nc] = api\r\n");
      out.write("\t\t\t                .column( nc, { page: 'current'} )\r\n");
      out.write("\t\t\t                .data()\r\n");
      out.write("\t\t\t                .reduce( function (a, b) {\r\n");
      out.write("\t\t\t                \t//console.log(a);\r\n");
      out.write("\t\t\t                   return intVal(a) + intVal(b);\r\n");
      out.write("\t\t\t                   \r\n");
      out.write("\t\t\t                }, 0 );\r\n");
      out.write("\t\t\t            $( api.column( nc ).footer() ).html('<center>'+\r\n");
      out.write("\t\t\t\t\t              pageTotal[nc] +'<br> (Total '+ total[nc] +') </center>'\r\n");
      out.write("\t\t\t\t\t            );  \r\n");
      out.write("\t\t\t                nc++;\r\n");
      out.write("\t\t\t        }\r\n");
      out.write("\t\t   \t\t\t\t   \t\t\r\n");
      out.write("\t   \t\t}\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t    } );\r\n");
      out.write("\t    \r\n");
      out.write("\t} );\r\n");
      out.write("</script>\r\n");
      out.write("\r\n");
      out.write("</head>\r\n");
      out.write("<body onload=\"mywinClose();\">\r\n");
      out.write("\t<div style=\"text-align: center;font-size: 18px;\"><b>RVNL Project Document Status Report  </b></div></br>\r\n");
      out.write("\t");

		String exportToExcel = request.getParameter("exportToExcel");
		/*if (exportToExcel != null
				&& exportToExcel.toString().equalsIgnoreCase("YES")) {
			response.setContentType("application/vnd.ms-excel");
			response.setHeader("Content-Disposition", "inline; filename="
					+ "excel.xls");

		}*/
	
      out.write('\r');
      out.write('\n');
      out.write('	');

	String docType=null;
		String piu1 = request.getParameter("piu");
		String project = request.getParameter("project");
		String docType2 = request.getParameter("doctype");
		if (docType2!=null) {
			 docType = URLEncoder.encode(docType2, "UTF-8");
			}
		String backurl = request.getParameter("backurl");
		session.setAttribute( "backurl", backurl );
		String t11=request.getParameter("t1");
		String t12=request.getParameter("t2");
		int t1=Integer.parseInt(t11);
		int t2=Integer.parseInt(t12);
			
	
      out.write("\r\n");
      out.write("\t<!-- <div id=\"pagereport\" style=\"text-align:center;fontsize=4px;\">\r\n");
      out.write("\t<b style=\"font-size:20px;text-decoration: underline;\">PIU WISE REPORT  </b></br>\r\n");
      out.write("\t\r\n");
      out.write("\t </p>\r\n");
      out.write("\t\r\n");
      out.write("\t</div> -->\r\n");
      out.write("\t<table border=0 class=\"table table-hover table-bordered\"\r\n");
      out.write("\t\tstyle=\"background: bisque;\">\r\n");
      out.write("\t\t<tr class=\"\">\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t");

	Date dateofsub;
	Date currentdate;
	Date pDate;
	Connection conn = null;
	Statement stmt = null, stmt1=null;
	ResultSet rs = null,rs1=null;
	String arguments=null;
	Context initCtx = new InitialContext();
	Context envCtx = (Context) initCtx.lookup("java:comp/env");
	DataSource ds = (DataSource) envCtx.lookup("jdbc/MySQLDB");

	conn = ds.getConnection();
	
	String Q3 = "select PIU_Of_RVNL from xx_projectattributes_master where project='"+ project+"'";
	stmt1 = conn.createStatement();
	rs1 = stmt1.executeQuery(Q3);
	if (rs1.next()) {
		piu1 = rs1.getString(1);

	}	
	
	int nc=4;
	String header=" ";
	String uri = request.getScheme() + "://" +   // "http" + "://
            request.getServerName() +       // "myhost"
            ":" +                           // ":"
            request.getServerPort() +       // "8080"
            request.getRequestURI() +       // "/people"
            "?" +                           // "?"
            request.getQueryString();  
	
	session.setAttribute( "BackUrl", uri );
	
		if (piu1 != "") {
			header=" "+header+"  "+"PIU Name :  " +piu1+ "  "+" <br>"; nc--;
	
      out.write("\r\n");
      out.write("\t\r\n");
      out.write("\t\r\n");
      out.write("\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>&nbsp;&nbsp;&nbsp;&nbsp;PIU\r\n");
      out.write("\t\t\t\t\tName :<b> ");
      out.print(piu1);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t<INPUT Type=\"hidden\" name=\"piu1\" id=\"piu1\" value=\"");
      out.print(piu1 );
      out.write("\" />\r\n");
      out.write("\t\t\t</font>\r\n");
      out.write("\t\t\t</th>\r\n");
      out.write("\t\t\t");

				}
				if (project != "") {
					header=" "+header+" "+"Project :  "+project+" "+" "; nc--;
			
      out.write("\r\n");
      out.write("\t\t\t<th width=\"450px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Project :  <b> ");
      out.print(project);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t<INPUT Type=\"hidden\" name=\"project1\" id=\"project1\" value=\"");
      out.print(project );
      out.write("\" />\r\n");
      out.write("\t\t\t</font>\r\n");
      out.write("\t\t\t</th>\r\n");
      out.write("\t\t\t");

				}
			
				if (docType != "") {
					header=" "+header+"  "+"Document Type :  "+docType2+" "+" "+" <br>";nc--;
			
      out.write("\r\n");
      out.write("\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Document Type :<b> ");
      out.print(docType2);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t<INPUT Type=\"hidden\" name=\"docType1\" id=\"docType1\" value=\"");
      out.print(docType2 );
      out.write("\" />\r\n");
      out.write("\t\t\t</font>\r\n");
      out.write("\t\t\t</th>\r\n");
      out.write("\t\t\t<!-- <th style=\"background-color: #ffff;\"></th> -->\r\n");
      out.write("\t\t\t<!--<th style=\"background-color: #ffff;\"></th> -->\r\n");
      out.write("\t\t\r\n");
      out.write("\t\r\n");
      out.write("\t");

		}
	
      out.write("</tr></table>\r\n");
      out.write("\t<INPUT Type=\"hidden\" name=\"message1\" id=\"message1\" value=\"");
      out.print(header );
      out.write("\" />\r\n");
      out.write("\t<br>\r\n");
      out.write("\t");

			
			
			
			String query1 ="select Q2.PIU_Of_RVNL, Q2.Project, Q2.Document_Type,sum(Q2.nos_reqd) as snos_reqd,sum(Q1.nprepared) as snprepared, sum(Q1.nappd) as snappd, sum(Q1.npending) as snpending, sum(Q1.notforwd) as snotforwd from (select  Piu_Of_RVNL, project, package_name, Project_Id, package_id, document_type, Document_Status, count(Document_Map_ID) as pcount, count(Document_Map_ID) as nprepared, count(if(Document_status='Finally approved',Document_Map_ID, null)) as nappd, count(if((Forwarded='yes' and Document_status='Pending'),Document_Map_ID, null)) as npending, count(if(((Forwarded='No' or isnull(Forwarded)=true) and Document_status='Pending'),Document_Map_ID, null)) as notforwd from (select docm.Document_Map_ID, projm.PIU_of_RVNL,projm.Project,pkgm.package_name,pkgm.package_id, projm.project_id, docm.Document_Type,docm.forwarded, docm.Document_Status  from xx_projectattributes_master projm,xx_packages_project pkgm,xx_document_mapping docm where projm.project_id = docm.project_id  and projm.Project_ID = pkgm.Project_ID and pkgm.package_id = docm.Package_ID  and docm.ShowInReport='y') as q1 group by q1.PIU_of_RVNL, q1.package_id, q1.project_id, q1.Document_Type) as Q1 right join (select a.PIU_of_RVNL, a.Project, b.package_name, b.package_id, a.project_id, d.Document_Type, c.nos_reqd from xx_projectattributes_master a, xx_packages_project b, xx_project_docnos c, xx_documentattributes_master d where b.package_id = c.package_id and a.project_id=c.project_id and c.document_type_id=d.document_Type_Id) as Q2 on Q1.package_id = Q2.package_id and Q1.project_id=Q2.project_id and Q1.document_type = Q2.document_Type"; 
			//select Q2.*,Q1.nprepared, Q1.nappd, Q1.npending from (select projm.PIU_of_RVNL,projm.Project,pkgm.package_name,pkgm.package_id, projm.project_id, docm.Document_Type,count(docm.Document_Map_ID) as nprepared, count(if(docm.Document_status='Finally Q1pproved',docm.Document_Map_ID, null)) as nappd, count(if((docm.Forwarded='yes' and docm.Document_status='Pending'),docm.Document_Map_ID, null)) as npending from xx_projectattributes_master projm,xx_packages_project pkgm,xx_document_mapping docm where projm.project_id = docm.project_id  and projm.Project_ID = pkgm.Project_ID and pkgm.package_id = docm.Package_ID  and docm.ShowInReport='y' group by docm.Zone,docm.Division, projm.PIU_of_RVNL,projm.Project,pkgm.package_name,projm.CoordinatingDepartment,projm.Designation,docm.Document_Type) as Q1 right join (select a.PIU_of_RVNL, a.Project, b.package_name, b.package_id, a.project_id, d.Document_Type, c.nos_reqd from xx_projectattributes_master a, xx_packages_project b, xx_project_docnos c, xx_documentattributes_master d where b.package_id = c.package_id and a.project_id=c.project_id and c.document_type_id=d.document_Type_Id) as Q2 on Q1.package_id = Q2.package_id and Q1.project_id=Q2.project_id and Q1.document_type = Q2.document_Type";
			String query=null;
		if (piu1 != "") {
			if (query==null) {
			query=" where Q2.PIU_of_RVNL='"+piu1+"'";
		} else {
			query=query+" and Q2.PIU_of_RVNL='"+piu1+"'";
		}
		}
			if (project != "") {
				if (query==null) {
				query=" where Q2.Project ='"+project+"'";
			} else {
				query=query+" and Q2.Project ='"+project+"'";
			}
			}
				if (docType != "") {
					if (query==null) {
					query=" where Q2.Document_Type='"+docType2+"'";
				} else {
					query=query+" and Q2.Document_Type='"+docType2+"'";
				}
				}
			//	System.out.println("qq"+query);
		query=query1+query+" group by Q2.PIU_of_RVNL, Q2.Project, Q2.Document_Type";
		//System.out.println("qq"+query);
		stmt = conn.createStatement();
		rs = stmt.executeQuery(query);
	
	
      out.write("\r\n");
      out.write("<table align=\"center\" width=\"50%\"><tr><td>\r\n");
      out.write("\t<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("\t\tstyle=\"background-color: #F0FFFF\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("\t\t<thead>\r\n");
      out.write("\t\t<tr class=\"success\">\r\n");
      out.write("\t\t\t<th   style=\"padding: 5px 10px 10px 5px;\">S.No.</th>\r\n");
      out.write("\t\t\t");
 int n=3;
				if (piu1 == "") {
			
      out.write("\r\n");
      out.write("\t\t\t<th    style=\"padding: 10px 10px 10px 10px;\">PIU</th>\r\n");
      out.write("\r\n");
      out.write("\t\t\t");

				} else {n--;}
			
				if (project == "") {
			
      out.write("\r\n");
      out.write("\t\t\t<th    width=\"250px\"  style=\"padding:10px 10px 10px 10px;\">Project</th>\r\n");
      out.write("\r\n");
      out.write("\t\t\t");

				} else { n--;}
			
      out.write(" \r\n");
      out.write("\t\t\t");

			if (docType == "") {
				
      out.write("\r\n");
      out.write("\t\t\t\t<th    width=\"250px\"  style=\"padding:10px 10px 10px 10px;\">Document Type</th>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");

					} else { n--;}
			
      out.write("\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t<th width=\"90px\" style=\"padding:10px 10px 10px 10px;\">Nos. Required</th>\r\n");
      out.write("\t\t\t\t<th width=\"90px\" style=\"padding:10px 10px 10px 10px;\">Nos. Prepared</th>\r\n");
      out.write("\t\t\t\t\t<th width=\"90px\" style=\"padding:10px 10px 10px 10px;\">Nos. Approved</th>\r\n");
      out.write("\t\t\t\t\t\t<th width=\"90px\" style=\"padding:10px 10px 10px 10px;\">Nos. Under Approval</th>\r\n");
      out.write("\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t</thead>\r\n");
      out.write("<tfoot>\t\r\n");
 n++;
int c=1;

      out.write("\r\n");
      out.write("<th colspan='");
      out.print(n );
      out.write("'><center><b>Total</b></center></th>\r\n");
 while (c<5) {

      out.write("\r\n");
      out.write("<th></th>\r\n");

//System.out.println("ccc"+c+"n"+n);
c++;
} 
      out.write("\r\n");
      out.write("\t\t</tfoot>\r\n");
      out.write("\t\t<tbody>\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t");
 int i=1;
		String doctyp=null;
			   	while (rs.next()) {

				//String Zone_name = rs.getString(1);
				//String division1 = rs.getString(2);
				String piu = rs.getString(1);
				String proj = rs.getString(2);
				//String packn = rs.getString(3);
				String doctyp3 = rs.getString(3);
				if (doctyp3!=null) {
			 	doctyp = URLEncoder.encode(doctyp3, "UTF-8");
				}
				String nreqd = rs.getString(4);
				String nprepared = rs.getString(5);
				String nappd = rs.getString(6);
				String npending = rs.getString(7);
			//System.out.println("appd="+nappd+"pend"+npending+"doct"+doctyp);		
				
			
      out.write("\r\n");
      out.write("\t\t<tr class=\"active\">\r\n");
      out.write("\t\t\t<td>");
      out.print(i);
      out.write("</td>\r\n");
      out.write("\t\t\t");

			if (piu1 != "") {
			
      out.write("\r\n");
      out.write("\t\t\t");

				} else {
			
      out.write("\r\n");
      out.write("\t\t\t<td>");
      out.print(piu);
      out.write("</td>\r\n");
      out.write("\t\t\t");

			piu = URLEncoder.encode(piu, "UTF-8");
				}
			
      out.write("\r\n");
      out.write("\t\t\t");

				if (project != "") {
			
      out.write("\r\n");
      out.write("\t\t\t");

				} else {
			
      out.write("\r\n");
      out.write("\t\t\t<td>");
      out.print(proj);
      out.write("</td>\r\n");
      out.write("\t\t\t");

			proj = URLEncoder.encode(proj, "UTF-8");
				}
			
      out.write("\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t");

			if (docType != "") {
				
      out.write("\r\n");
      out.write("\t\t\t\t");

					} else {
				
      out.write("\r\n");
      out.write("\t\t\t\t<td>");
      out.print(doctyp3);
      out.write("</td>\r\n");
      out.write("\t\t\t\t");

					}

			
			//packn = URLEncoder.encode(packn, "UTF-8");
			
			String url21="ReportPIU_ProjStatus_details.jsp?PIU_name="+piu+"&project="+proj+"&packno=&docType="+doctyp+"&status=Finally Approved";
			String url31=url21.replace(" ","+");
			String url41="PublicReport.jsp?piu=&project="+proj+"&packno=&doctype="+doctyp+"&status=&majsec=&smajsec=&frmstn=&tostn=&orgName=&backurl=&t1=7&t2=14&frmkm=&tokm=&DateStart=&DateEnd=&frmstnkm=&tostnkm=&division=none&zone=";
			String url51=url41.replace(" ","+");
			
			if (nreqd == null) {
				
      out.write("\r\n");
      out.write("\t\t\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t\t");
	
				} else {
				
      out.write("\r\n");
      out.write("\t\t\t\t\t<td><center>");
      out.print(nreqd );
      out.write("</a></center></td>\r\n");
      out.write("\t\t\t\t\t");
 } 
			if (nprepared == null) {
				
      out.write("\r\n");
      out.write("\t\t\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t\t");
 } else {
				
      out.write("\r\n");
      out.write("\t\t\t\t\t<td><center>");
      out.print(nprepared );
      out.write("</a></center></td>\r\n");
      out.write("\t\t\t\t\t");
 } 
				if (nappd == null || nappd.equalsIgnoreCase("0")) {
			
      out.write("\r\n");
      out.write("\t\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t");
	} else {
			
      out.write("\r\n");
      out.write("\t\t\t<td><center><a href=\"");
      out.print(url31 );
      out.write('"');
      out.write('>');
      out.print(nappd);
      out.write("</a></center></td>\r\n");
      out.write("\t\t\t");
 }
			if (npending == null || npending.equalsIgnoreCase("0")) {
				
      out.write("\r\n");
      out.write("\t\t\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t\t");
	} else {
				
      out.write("\r\n");
      out.write("\t\t\t\t\t<td><center><a href=\"");
      out.print(url51 );
      out.write('"');
      out.write('>');
      out.print(npending );
      out.write("</a></center></td>\r\n");
      out.write("\t\t\t\t\t");
 } 
			
				
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t</tr>\r\n");
      out.write("\t\t");

			i++;
			}
		   
		rs.close();

		conn.close();
		
		
      out.write("\r\n");
      out.write("\t\t  \r\n");
      out.write("\t\t</tbody>\r\n");
      out.write("\t</table></td></tr></table>\r\n");
      out.write("\t<br>\r\n");
      out.write("\t\t<input type=\"button\" value=\"close\" class=\"btn btn-primary\" onclick=\"closeMe();\" style=\"margin-left: 50%;\"> \r\n");
      out.write("\t\r\n");
      out.write("\t");

		if (exportToExcel == null) {
	
	
		}
	
      out.write("\r\n");
      out.write("\t<br>\r\n");
      out.write("\t<!-- <a href=\"#\" onclick=\"javascript:window.print();\">Print this page</a> -->\r\n");
      out.write("<br>\r\n");
      out.write("</body>\r\n");
      out.write("\r\n");
      out.write("</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
