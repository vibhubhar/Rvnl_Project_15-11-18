/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.86
 * Generated at: 2018-06-19 18:29:38 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.Admin;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import javax.naming.*;
import java.sql.*;
import javax.sql.*;
import java.io.FileOutputStream;
import javax.servlet.*;
import javax.servlet.http.*;
import java.util.*;
import javax.naming.*;
import java.sql.*;
import javax.sql.*;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.Element;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.pdf.BaseFont;
import com.itextpdf.text.BaseColor;
import com.itextpdf.text.Font;
import java.awt.Color;
import com.itextpdf.text.pdf.PdfWriter;
import com.itextpdf.text.Document;
import com.itextpdf.text.Chunk;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.text.DateFormat;
import java.net.URLEncoder;
import org.joda.time.DateTime;
import org.joda.time.Days;
import org.joda.time.Hours;
import org.joda.time.Minutes;
import org.joda.time.Seconds;

public final class ReportPIU_005fspecial_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);
    _jspx_dependants.put("/WEB-INF/sessionCheck1.jspf", Long.valueOf(1524567358000L));
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=ISO-8859-1");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 1120256, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

 
int timeout = session.getMaxInactiveInterval();
response.setHeader("Refresh", timeout + "; URL = admn_login.jsp");

      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("<title>PDAMS - Report</title>\r\n");
      out.write("<style>\r\n");
      out.write(".dt-button.buttons-copy.buttons-html5 {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write(".dt-button.buttons-csv.buttons-html5 {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write(".dt-button.buttons-pdf.buttons-html5 {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write("#example_length {\r\n");
      out.write("    display: none;\r\n");
      out.write("}\r\n");
      out.write("#example {\r\n");
      out.write("    width: inherit;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("table {\r\n");
      out.write("\tmso-displayed-decimal-separator: \"\\.\";\r\n");
      out.write("\tmso-displayed-thousand-separator: \"\\,\";\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("@page {\r\n");
      out.write("\tmargin: 1.0in .75in 1.0in .75in;\r\n");
      out.write("\tmso-header-margin: .5in;\r\n");
      out.write("\tmso-footer-margin: .5in;\r\n");
      out.write("\tmso-page-orientation: landscape;\r\n");
      out.write("}\r\n");
      out.write("</style>\r\n");
      out.write("\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.css\" rel=\"stylesheet\" />\r\n");
      out.write("<!-- <title>PIU Level Report</title> -->\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<script src=\"resources/JS/validateSysAdmin230.js\"></script>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"https://code.jquery.com/jquery-1.12.4.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"https://code.jquery.com/ui/1.12.1/jquery-ui.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"http://www.allmyscripts.com/Table_Sort/beta/gs_sortable.js\"></script>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js\"></script>\r\n");
      out.write("<script\r\n");
      out.write("\tsrc=\"http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/jquery-ui.js\"\r\n");
      out.write("\ttype=\"text/javascript\"></script>\r\n");
      out.write("<script src=\"resources/JS/Approval_wf230.js\"></script>\r\n");
      out.write("<link\r\n");
      out.write("\thref=\"http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/themes/blitzer/jquery-ui.css\"\r\n");
      out.write("\trel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("\r\n");
      out.write("<link href=\"resources/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\r\n");
      out.write("<link rel=\"stylesheet\"\r\n");
      out.write("\thref=\"//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css\">\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n");
      out.write("<link href=\"resources/bootstrap/css/bootstrap.css\" rel=\"stylesheet\" />\r\n");
      out.write("<script src=\"resources/JS/backButton.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/validate230.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/PIU_depend230.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\"\r\n");
      out.write("\tsrc=\"resources/JS/datasort.js\"></script>\r\n");
      out.write("\t<link\r\n");
      out.write("\thref=\"https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css\"\r\n");
      out.write("\trel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("\t\r\n");
      out.write("<link href=\"resources/css/buttons.dataTables.min.css\" rel=\"stylesheet\" type=\"text/css\">\r\n");
      out.write("<script src=\"resources/JS/jquery-1.12.4.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/jquery.dataTables.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/dataTables.buttons.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/buttons.flash.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/jszip.min.js\"></script>\r\n");
      out.write("<!-- <script src=\"resources/JS/pdfmake.min.js\"></script> -->\r\n");
      out.write("<script src=\"resources/JS/vfs_fonts.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/buttons.print.min.js\"></script>\r\n");
      out.write("<script src=\"resources/JS/buttons.html5.min.js\"></script>\r\n");
      out.write("<script>\r\n");
      out.write("function myFunction() {\r\n");
      out.write("    window.print();\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("function closeMe()\r\n");
      out.write("{\r\n");
      out.write("var win = window.open(\"\",\"_self\"); \r\n");
      out.write("win.close();\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("function mywinClose() {\r\n");
      out.write("\tvar sessionTimeout1 = \"");
      out.print( session.getMaxInactiveInterval() );
      out.write("\";\r\n");
      out.write("\tsetTimeout(function(){var parent1=window.open(\"\",\"report_master\"); parent1.close(); },(sessionTimeout1-10)*1000);\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("\r\n");
      out.write("\t<script>\r\n");
      out.write("\t$(document).ready(function() {\r\n");
      out.write("\t\tvar nc1=4;\r\n");
      out.write("\t\tvar message1=document.getElementById(\"message1\").value;\r\n");
      out.write("\t\tvar zone1=document.getElementById(\"zone1\");\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tif(zone1==null){\r\n");
      out.write("\t\t\tzone1=\"\";\r\n");
      out.write("\t\t}else{\r\n");
      out.write("\t\t\tvar zone1=document.getElementById(\"zone1\").value;\r\n");
      out.write("\t\t\tzone1=\"Zone :\"+zone1; nc1--;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar status1=document.getElementById(\"status1\");\r\n");
      out.write("\t\tif(status1==null){\r\n");
      out.write("\t\t\tstatus1=\"\";\r\n");
      out.write("\t\t}else{\r\n");
      out.write("\t\t\tvar status1=document.getElementById(\"status1\").value;\r\n");
      out.write("\t\t\tstatus1=\"Status:\"+status1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar division1=document.getElementById(\"division1\");\r\n");
      out.write("\t\tif(division1==null){\r\n");
      out.write("\t\t\tdivision1=\"\";\r\n");
      out.write("\t\t}else{\r\n");
      out.write("\t\t\tvar division1=document.getElementById(\"division1\").value;\r\n");
      out.write("\t\t\tdivision1=\"Division :\"+division1; nc1--;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tpiu1=document.getElementById(\"piu1\");\r\n");
      out.write("\t\tif(piu1==null){\r\n");
      out.write("\t\t\tpiu1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tpiu1=document.getElementById(\"piu1\").value;\r\n");
      out.write("\t\t\tpiu1=\"PIU :\"+piu1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar projType1=document.getElementById(\"projType1\");\r\n");
      out.write("\t\tif(projType1==null){\r\n");
      out.write("\t\t\tprojType1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar projType1=document.getElementById(\"projType1\").value;\r\n");
      out.write("\t\t\tprojType1=\"Project Type :\"+projType1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\r\n");
      out.write("\t\tvar project1=document.getElementById(\"project1\");\r\n");
      out.write("\t\tif(project1==null){\r\n");
      out.write("\t\t\tproject1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tproject1=document.getElementById(\"project1\").value;\r\n");
      out.write("\t\t\tproject1=\"Project :\"+project1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar docType1=document.getElementById(\"docType1\");\r\n");
      out.write("\t\tif(docType1==null){\r\n");
      out.write("\t\t\tdocType1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar docType1=document.getElementById(\"docType1\").value;\r\n");
      out.write("\t\t\tdocType1=\"Document Name :\"+docType1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar eDate1=document.getElementById(\"eDate1\");\r\n");
      out.write("\t\tif(eDate1==null){\r\n");
      out.write("\t\t\teDate1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar eDate1=document.getElementById(\"eDate1\").value;\r\n");
      out.write("\t\t\teDate1=\"Submitted Before :\"+eDate1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar sDate1=document.getElementById(\"sDate1\");\r\n");
      out.write("\t\tif(sDate1==null){\r\n");
      out.write("\t\t\tsDate1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar sDate1=document.getElementById(\"sDate1\").value;\r\n");
      out.write("\t\t\tsDate1=\"Submitted After :\"+sDate1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar majsec1=document.getElementById(\"majsec1\");\r\n");
      out.write("\t\tif(majsec1==null){\r\n");
      out.write("\t\t\tmajsec1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar majsec1=document.getElementById(\"majsec1\").value;\r\n");
      out.write("\t\t\tmajsec1=\"Major Section :\"+majsec1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar smajsec1=document.getElementById(\"smajsec1\");\r\n");
      out.write("\t\tif(smajsec1==null){\r\n");
      out.write("\t\t\tsmajsec1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar smajsec1=document.getElementById(\"smajsec1\").value;\r\n");
      out.write("\t\t\tsmajsec1=\"Major Section :\"+smajsec1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar frmkm1=document.getElementById(\"frmkm1\");\r\n");
      out.write("\t\tif(frmkm1==null){\r\n");
      out.write("\t\t\tfrmkm1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar frmkm1=document.getElementById(\"frmkm1\").value;\r\n");
      out.write("\t\t\tfrmkm1=\"From Km :\"+frmkm1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar tokm1=document.getElementById(\"tokm1\");\r\n");
      out.write("\t\tif(tokm1==null){\r\n");
      out.write("\t\t\ttokm1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar tokm1=document.getElementById(\"tokm1\").value;\r\n");
      out.write("\t\t\ttokm1=\"To Km :\"+tokm1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar frmstn1=document.getElementById(\"frmstn1\");\r\n");
      out.write("\t\tif(frmstn1==null){\r\n");
      out.write("\t\t\tfrmstn1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar frmstn1=document.getElementById(\"frmstn1\").value;\r\n");
      out.write("\t\t\tvar frmstnkm1=document.getElementById(\"frmstnkm1\").value;\r\n");
      out.write("\t\t\tfrmstn1=\"From Station (Km) :\"+frmstn1+\" (\"+frmstnkm1+\")\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar tostn1=document.getElementById(\"tostn1\");\r\n");
      out.write("\t\tif(tostn1==null){\r\n");
      out.write("\t\t\ttostn1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar tostn1=document.getElementById(\"tostn1\").value;\r\n");
      out.write("\t\t\tvar tostnkm1=document.getElementById(\"tostnkm1\").value;\r\n");
      out.write("\t\t\ttostn1=\"To Station (Km) :\"+tostn1+\" (\"+tostnkm1+\")\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar org1=document.getElementById(\"org1\");\r\n");
      out.write("\t\tif(org1==null){\r\n");
      out.write("\t\t\torg1=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar org1=document.getElementById(\"org1\").value;\r\n");
      out.write("\t\t\torg1=\"Pending with Organization :\"+org1;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar pkl1=zone1+\"               \"+division1+\"               \"+piu1+\"              \"+projType1+\"              \"+project1;\r\n");
      out.write("\t    var pkl2=status1+\"              \"+docType1+\"               \"+eDate1+\"               \"+sDate1;\r\n");
      out.write("\t    var pkl3=majsec1+\"               \"+smajsec1;\r\n");
      out.write("\t    var pkl4=frmkm1+\"               \"+tokm1+\"               \"+frmstn1+\"               \"+tostn1+\"               \"+org1;\r\n");
      out.write("\t    \r\n");
      out.write("\t   \r\n");
      out.write("\t   \t\t$('#example').DataTable( {\r\n");
      out.write("   \t\t\t\r\n");
      out.write("\t    \t\"infoCallback\": function( settings, start, end, max, total, pre ) {\r\n");
      out.write("\t\t\t\tif (max==total) { return \"Showing \" + (end-start+1) + \"  of \" +total+\" records\"}\r\n");
      out.write("\t\t\t\telse {return \"Showing \" + (end-start+1) + \"  of \" +total+\" records (filtered from total \" + max+\" records)\"}\r\n");
      out.write("\t\t\t   \t},\r\n");
      out.write("\t    \r\n");
      out.write("\t    \t\r\n");
      out.write("\t        dom: 'Bfrtip',\r\n");
      out.write("\t        lengthMenu: [\r\n");
      out.write("\t                     [ 10, 25, 50, -1 ],\r\n");
      out.write("\t                     [ '10 rows', '25 rows', '50 rows', 'Show all' ]\r\n");
      out.write("\t                 ],\r\n");
      out.write("\t                 \"columnDefs\": [\r\n");
      out.write("\t                     {\r\n");
      out.write("\t                         \"targets\": [-1 ],\r\n");
      out.write("\t                         \"visible\": false\r\n");
      out.write("\t                     }\r\n");
      out.write("\t                 ],\r\n");
      out.write("\t                // columns: [':visible :not(:last-child)'],\r\n");
      out.write("\t        buttons: [\r\n");
      out.write("'pageLength',\r\n");
      out.write("\r\n");
      out.write("\t                  \r\n");
      out.write("{exportOptions: {\r\n");
      out.write("\t  \r\n");
      out.write("\t// columns: [':visible :not(9)']\r\n");
      out.write("},\r\n");
      out.write("    extend: 'print',\r\n");
      out.write("    footer: true,\r\n");
      out.write("    message: message1,\r\n");
      out.write("    title: 'RVNL DOCUMENT DEPARTMENT WISE SUMMARY REPORT',\r\n");
      out.write("    customize: function (win) {\r\n");
      out.write("        $(win.document.body).find('table').addClass('display').css('font-size', '9px');\r\n");
      out.write("        $(win.document.body).find('tr:nth-child(odd) td').each(function(index){\r\n");
      out.write("            $(this).css('background-color','#D0D0D0');\r\n");
      out.write("        });\r\n");
      out.write("        $(win.document.body).find('h1').css('text-align','center');\r\n");
      out.write("        var footer = $('tfoot');\r\n");
      out.write(" \t    if (footer.length > 0) {\r\n");
      out.write(" \t        var exportFooter = $(win.document.body).find('tfoot:eq(0)');\r\n");
      out.write(" \t        exportFooter.after(footer.clone());\r\n");
      out.write(" \t        exportFooter.remove();\r\n");
      out.write(" \t    }\r\n");
      out.write(" \t \r\n");
      out.write("    }\r\n");
      out.write("},\r\n");
      out.write("          \r\n");
      out.write("{exportOptions: {\r\n");
      out.write("   // columns: [':visible :not(9)']\r\n");
      out.write("}, \r\n");
      out.write("\t                  \r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  //'print',\r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                 title: 'RVNL DOCUMENT DEPARTMENT WISE SUMMARY REPORT',\r\n");
      out.write("\t\t                  extend: 'excel',\r\n");
      out.write("\t\t                  footer: true,\r\n");
      out.write("\t\t                 \r\n");
      out.write("\t\t                  fixedHeader: {\r\n");
      out.write("\t\t                      header: true,\r\n");
      out.write("\t\t                      footer: true\r\n");
      out.write("\t\t                  },\r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  customize: function (xlsx) {\r\n");
      out.write("\t\t                      var sheet = xlsx.xl.worksheets['sheet1.xml'];\r\n");
      out.write("\t\t                      var numrows = 6;\r\n");
      out.write("\t\t                      var clR = $('row', sheet);\r\n");
      out.write("\r\n");
      out.write("\t\t                      //update Row\r\n");
      out.write("\t\t                      clR.each(function () {\r\n");
      out.write("\t\t                          var attr = $(this).attr('r');\r\n");
      out.write("\t\t                          var ind = parseInt(attr);\r\n");
      out.write("\t\t                          ind = ind + numrows;\r\n");
      out.write("\t\t                          $(this).attr(\"r\",ind);\r\n");
      out.write("\t\t                      });\r\n");
      out.write("\t\t                      var message33=document.getElementById(\"message1\").value;\r\n");
      out.write("\t\t                      // Create row before data\r\n");
      out.write("\t\t                      $('row c ', sheet).each(function () {\r\n");
      out.write("\t\t                          var attr = $(this).attr('r');\r\n");
      out.write("\t\t                          var pre = attr.substring(0, 1);\r\n");
      out.write("\t\t                          var ind = parseInt(attr.substring(1, attr.length));\r\n");
      out.write("\t\t                          ind = ind + numrows;\r\n");
      out.write("\t\t                          $(this).attr(\"r\", pre + ind);\r\n");
      out.write("\t\t                      });\r\n");
      out.write("\r\n");
      out.write("\t\t                      function Addrow(index,data) {\r\n");
      out.write("\t\t                          msg='<row r=\"'+index+'\">'\r\n");
      out.write("\t\t                          for(i=0;i<data.length;i++){\r\n");
      out.write("\t\t                              var key=data[i].key;\r\n");
      out.write("\t\t                              var value=data[i].value;\r\n");
      out.write("\t\t                              msg += '<c t=\"inlineStr\" r=\"' + key + index + '\">';\r\n");
      out.write("\t\t                              msg += '<is>';\r\n");
      out.write("\t\t                              msg +=  '<t>'+value+'</t>';\r\n");
      out.write("\t\t                              msg+=  '</is>';\r\n");
      out.write("\t\t                              msg+='</c>';\r\n");
      out.write("\t\t                          }\r\n");
      out.write("\t\t                          msg += '</row>';\r\n");
      out.write("\t\t                          return msg;\r\n");
      out.write("\t\t                      }\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t                      //insert\r\n");
      out.write("\t\t                      var r1 = Addrow(1, [{ key: 'F', value:  'RVNL DOCUMENT DEPARTMENT WISE SUMMARY REPORT' }]);\r\n");
      out.write("\t\t                      var r2 = Addrow(2, [{ key: 'A', value: pkl1 }]);\r\n");
      out.write("\t\t                       var r3 = Addrow(3, [{ key: 'A', value: pkl2 }]);\r\n");
      out.write("\t\t                      var r4 = Addrow(4, [{ key: 'A', value: pkl3}]);\r\n");
      out.write("\t\t                      var r5 = Addrow(5, [{ key: 'A', value: pkl4}]);\r\n");
      out.write("\t\t                      \r\n");
      out.write("\t\t                      sheet.childNodes[0].childNodes[1].innerHTML = r1+r2+r3+r4+r5+ sheet.childNodes[0].childNodes[1].innerHTML;\t\r\n");
      out.write("\t\t                  }\r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  \r\n");
      out.write("\t\t                  }\r\n");
      out.write("\t                  \r\n");
      out.write("\t                  ], \t   \t\t\t\r\n");
      out.write("\t                  \r\n");
      out.write("\t                \"footerCallback\": function ( tfoot, data, start, end, display ) {\r\n");
      out.write("\t  \t\t            var api = this.api(), data;\r\n");
      out.write("\t\t\t            // Remove the formatting to get integer data for summation\r\n");
      out.write("\t\t\t            var intVal = function ( i ) {\r\n");
      out.write("\t\t\t            \treturn typeof i === 'string' ?\r\n");
      out.write("\t\t\t            \t\t\t\ti.replace(/(<([^>]+)>)(\\-?)/ig, '')*1 :\r\n");
      out.write("\t\t\t                   typeof i === 'number' ?\r\n");
      out.write("\t\t\t                        i : 0;\r\n");
      out.write("\t\t\t            \t\r\n");
      out.write("\t\t\t            };\r\n");
      out.write("\t\t\t  var nc=0;\r\n");
      out.write("\t\t\t  var bc=nc1+1;\r\n");
      out.write("\t\t\t  var pageTotal=[];\r\n");
      out.write("\t\t\t  var total=[];\r\n");
      out.write("\t\t\t while (nc<bc+5) {\t\t            \r\n");
      out.write("\t\t\t\t // Total over all pages\r\n");
      out.write("\t\t\t            total[nc] = api\r\n");
      out.write("\t\t\t                .column(nc)\r\n");
      out.write("\t\t\t                .data()\r\n");
      out.write("\t\t\t                .reduce( function (a, b) {\r\n");
      out.write("\t\t\t                    return intVal(a) + intVal(b);\r\n");
      out.write("\t\t\t                    \r\n");
      out.write("\t\t\t                }, 0 );\r\n");
      out.write("\t\t\t \r\n");
      out.write("\t\t\t            // Total over this page\r\n");
      out.write("\t\t\t            pageTotal[nc] = api\r\n");
      out.write("\t\t\t                .column( nc, { page: 'current'} )\r\n");
      out.write("\t\t\t                .data()\r\n");
      out.write("\t\t\t                .reduce( function (a, b) {\r\n");
      out.write("\t\t\t                \t//console.log(a);\r\n");
      out.write("\t\t\t                   return intVal(a) + intVal(b);\r\n");
      out.write("\t\t\t                   \r\n");
      out.write("\t\t\t                }, 0 );\r\n");
      out.write("\t\t\t                nc++;\r\n");
      out.write("\t\t\t        }\r\n");
      out.write("\t\t   \t\t\r\n");
      out.write("\t\t   \t\tnc=bc-1;\r\n");
      out.write("\t\t   \t\twhile (nc<bc+5) {\r\n");
      out.write("\r\n");
      out.write("\t\t            // Update footer\r\n");
      out.write("\t\t \t  if (nc!=bc) {   $( api.column( nc ).footer() ).html('<center>'+\r\n");
      out.write("\t\t              pageTotal[nc] +'<br> (Total '+ total[nc] +') </center>'\r\n");
      out.write("\t\t            ); } else  {\r\n");
      out.write("\t\t           \r\n");
      out.write("\t\t\t$( api.column( bc ).footer() ).html('<center>'+\r\n");
      out.write("\t\t            (pageTotal[bc+4]/pageTotal[bc-1]).toFixed(2) +'<br> (Total '+ (total[bc+4]/total[bc-1]).toFixed(2) +') </center>'\r\n");
      out.write("\t\t           );\r\n");
      out.write("\t\t   \t\t\t}\r\n");
      out.write("\t                  nc++;\r\n");
      out.write("\t                  }\r\n");
      out.write("\t   \t\t}\r\n");
      out.write("\t    } );\r\n");
      out.write("\t    \r\n");
      out.write("\t} );\r\n");
      out.write("</script>\r\n");
      out.write("\r\n");
      out.write("</head>\r\n");
      out.write("<body onload=\"mywinClose();\">\r\n");
      out.write("\t<div style=\"text-align: center;font-size: 18px;\"><b>RVNL Document Department wise Summary Report  </b></div></br>\r\n");
      out.write("\t");

		String exportToExcel = request.getParameter("exportToExcel");
		/*if (exportToExcel != null
				&& exportToExcel.toString().equalsIgnoreCase("YES")) {
			response.setContentType("application/vnd.ms-excel");
			response.setHeader("Content-Disposition", "inline; filename="
					+ "excel.xls");

		}*/
	
      out.write('\r');
      out.write('\n');
      out.write('	');

	String docType=null;
		String piu1 = request.getParameter("PIU_name");
		String status = request.getParameter("status");
		String project = request.getParameter("project");
		String docType2 = request.getParameter("doctype");
		if (docType2!=null) {
			 docType = URLEncoder.encode(docType2, "UTF-8");
			}
		//String sDate = request.getParameter("sDate");
		//String eDate = request.getParameter("eDate");
		String projtype = request.getParameter("projtype");
		String  majsec = request.getParameter("majsec");	
		String  smajsec = request.getParameter("smajsec");	
		String  frmkm = request.getParameter("frmkm");	
		String  tokm = request.getParameter("tokm");
		String  frmstn = request.getParameter("frmstn");	
		String  tostn = request.getParameter("tostn");	
		String  frmstnkm = request.getParameter("frmstnkm");	
		String  tostnkm = request.getParameter("tostnkm");	
		String  org = request.getParameter("orgName");	
		String sDate = request.getParameter("DateStart");
		String eDate = request.getParameter("DateEnd");
		String zone=request.getParameter("zone");
		String division=request.getParameter("division");
		String Date_of_Submission ="";
		String backurl = request.getParameter("backurl");
		session.setAttribute( "backurl", backurl );
		String t11=request.getParameter("t1");
		String t12=request.getParameter("t2");
		int t1=Integer.parseInt(t11);
		int t2=Integer.parseInt(t12);
		if ( division.equalsIgnoreCase("none") ){
			division="";
		}
			
		if(division.equalsIgnoreCase("-1")){
			division="";
		}
		
		//String ds1 = "2016/06/29";30/09/2012
		// for start Date format
		
		
		
		
	
      out.write("\r\n");
      out.write("\t<!-- <div id=\"pagereport\" style=\"text-align:center;fontsize=4px;\">\r\n");
      out.write("\t<b style=\"font-size:20px;text-decoration: underline;\">PIU WISE REPORT  </b></br>\r\n");
      out.write("\t\r\n");
      out.write("\t </p>\r\n");
      out.write("\t\r\n");
      out.write("\t</div> -->\r\n");
      out.write("\t<table border=0 class=\"table table-hover table-bordered\"\r\n");
      out.write("\t\tstyle=\"background: bisque;\">\r\n");
      out.write("\t\t<tr class=\"\">\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t");

	String header=" ";
	String uri = request.getScheme() + "://" +   // "http" + "://
            request.getServerName() +       // "myhost"
            ":" +                           // ":"
            request.getServerPort() +       // "8080"
            request.getRequestURI() +       // "/people"
            "?" +                           // "?"
            request.getQueryString();  
	
	session.setAttribute( "BackUrl", uri );
	if (status != "") {
		header="   "+header+ "Status : " +status+ "    "+" ";
		
      out.write("\r\n");
      out.write("\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Status :<b> ");
      out.print(status);
      out.write("</b>\r\n");
      out.write("\t\t\t\t<INPUT Type=\"hidden\" name=\"status1\" id=\"status1\" value=\"");
      out.print(status );
      out.write("\" />\r\n");
      out.write("\t\t</font>\r\n");
      out.write("\t\t</th>\r\n");
      out.write("\t\t");

			}
	
	if(zone !=""){
		header="   "+header+"  "+"Zone :"+zone+ " "+"<br> ";
		
      out.write("\r\n");
      out.write("\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t&nbsp;&nbsp;&nbsp;&nbsp;Zone :<b> ");
      out.print(zone);
      out.write("</b>\r\n");
      out.write("\t\t<INPUT Type=\"hidden\" name=\"zone1\" id=\"zone1\" value=\"");
      out.print(zone );
      out.write("\" />\r\n");
      out.write("</font>\r\n");
      out.write("</th>\r\n");
      out.write("\t\t\t\t\t");

		
	}if(division !=""){
		header=" "+header+"  "+"Division :"+division+" "+" ";
		
      out.write("\r\n");
      out.write("\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t&nbsp;&nbsp;&nbsp;&nbsp;Division :<b> ");
      out.print(division);
      out.write("</b>\r\n");
      out.write("\t\t<INPUT Type=\"hidden\" name=\"division1\" id=\"division1\" value=\"");
      out.print(division );
      out.write("\" />\r\n");
      out.write("</font>\r\n");
      out.write("</th>\r\n");
      out.write("\t\t");

		
	}
		if (piu1 != "") {
			header=" "+header+"  "+"PIU Name :  " +piu1+ "  "+" <br>";
	
      out.write("\r\n");
      out.write("\t\r\n");
      out.write("\t\r\n");
      out.write("\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>&nbsp;&nbsp;&nbsp;&nbsp;PIU\r\n");
      out.write("\t\t\t\t\tName :<b> ");
      out.print(piu1);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t<INPUT Type=\"hidden\" name=\"piu1\" id=\"piu1\" value=\"");
      out.print(piu1 );
      out.write("\" />\r\n");
      out.write("\t\t\t</font>\r\n");
      out.write("\t\t\t</th>\r\n");
      out.write("\t\t\t");

				}
		if (projtype != "") {
			header=" "+header+"  "+"Project Type :  "+projtype+" "+" ";;
	
      out.write("\r\n");
      out.write("\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Project Type :<b> ");
      out.print(projtype);
      out.write("</b>\r\n");
      out.write("\t\t\t<INPUT Type=\"hidden\" name=\"projType1\" id=\"projType1\" value=\"");
      out.print(projtype );
      out.write("\" />\r\n");
      out.write("\t</font>\r\n");
      out.write("\t</th>\r\n");

}

				if (project != "") {
					header=" "+header+" "+"Project :  "+project+" "+" ";
			
      out.write("\r\n");
      out.write("\t\t\t<th width=\"450px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Project :  <b> ");
      out.print(project);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t<INPUT Type=\"hidden\" name=\"project1\" id=\"project1\" value=\"");
      out.print(project );
      out.write("\" />\r\n");
      out.write("\t\t\t</font>\r\n");
      out.write("\t\t\t</th>\r\n");
      out.write("\t\t\t");

				}
			
				if (docType != "") {
					header=" "+header+"  "+"Document Type :  "+docType2+" "+" "+" <br>";;
			
      out.write("\r\n");
      out.write("\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Document Type :<b> ");
      out.print(docType2);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t<INPUT Type=\"hidden\" name=\"docType1\" id=\"docType1\" value=\"");
      out.print(docType2 );
      out.write("\" />\r\n");
      out.write("\t\t\t</font>\r\n");
      out.write("\t\t\t</th>\r\n");
      out.write("\t\t\t<!-- <th style=\"background-color: #ffff;\"></th> -->\r\n");
      out.write("\t\t\t<!--<th style=\"background-color: #ffff;\"></th> -->\r\n");
      out.write("\t\t\r\n");
      out.write("\t\r\n");
      out.write("\t");

		}
			
				if(sDate!=""){
					header=" "+header+"  "+"Submitted After :  "+sDate+" ";
					
      out.write("\r\n");
      out.write("\t\t\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Submitted After :<b> ");
      out.print(sDate);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"sDate1\" id=\"sDate1\" value=\"");
      out.print(sDate );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t</font></th>\r\n");
      out.write("\t\t\t\t\t");

					}
						
						if(eDate!=""){
							header=header+"  "+"Submitted Before :  "+eDate+" ";
					
      out.write("\r\n");
      out.write("\t\t\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Submitted Before :  <b> ");
      out.print(eDate);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"eDate1\" id=\"eDate1\" value=\"");
      out.print(eDate );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t</font></th>\r\n");
      out.write("\t\t\t\t\t");

					}
						if(smajsec!=""){
							header=header+"<br> "+"  "+"Major Section :  "+smajsec+" ";
					
      out.write("\r\n");
      out.write("\t\t\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Major Section :  <b> ");
      out.print(smajsec);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"smajsec1\" id=\"smajsec1\" value=\"");
      out.print(smajsec );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t</font></th>\r\n");
      out.write("\t\t\t\t\t");

					}
						if(majsec!=""){
							header=header+"  "+"Major Section :  "+majsec+" ";
					
      out.write("\r\n");
      out.write("\t\t\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Major Section :  <b> ");
      out.print(majsec);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"majsec1\" id=\"majsec1\" value=\"");
      out.print(majsec );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t</font></th>\r\n");
      out.write("\t\t\t\t\t");

						}
						if(frmkm!=""){
							header=header+"  "+"From Km :  "+frmkm+" ";
					
      out.write("\r\n");
      out.write("\t\t\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;From Km :  <b> ");
      out.print(frmkm);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"frmkm1\" id=\"frmkm1\" value=\"");
      out.print(frmkm );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t</font></th>\r\n");
      out.write("\t\t\t\t\t");

					}
						if(tokm!=""){
							header=header+"  "+"To Km :  "+tokm+" ";
					
      out.write("\r\n");
      out.write("\t\t\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;To Km :  <b> ");
      out.print(tokm);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"tokm1\" id=\"tokm1\" value=\"");
      out.print(tokm );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t</font></th>\r\n");
      out.write("\t\t\t\t\t");

					}
						if(frmstn!=""){
							header=header+"  "+"From Station :  "+frmstn+" (Km "+frmstnkm+")  ";
					
      out.write("\r\n");
      out.write("\t\t\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;From Station :  <b> ");
      out.print(frmstn);
      out.write(" &nbsp;(Km &nbsp;");
      out.print(frmstnkm);
      out.write(")</b> \r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"frmstn1\" id=\"frmstn1\" value=\"");
      out.print(frmstn );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"frmstnkm1\" id=\"frmstnkm1\" value=\"");
      out.print(frmstnkm );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t</font></th>\r\n");
      out.write("\t\t\t\t\t");

					}
						if(tostn!=""){
							header=header+"  "+"To Station :  "+tostn+" (Km "+tostnkm+")  "+"<br> ";
					
      out.write("\r\n");
      out.write("\t\t\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;To Station :  <b> ");
      out.print(tostn);
      out.write(" &nbsp;(Km &nbsp; ");
      out.print(tostnkm);
      out.write(")</b>\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"tostn1\" id=\"tostn1\" value=\"");
      out.print(tostn );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"tostnkm1\" id=\"tostnkm1\" value=\"");
      out.print(tostnkm );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t</font></th>\r\n");
      out.write("\t\t\t\t\t");

					}			
						if(org!=""){
							header=header+"  "+"Pending with Organization :  "+org+" ";
					
      out.write("\r\n");
      out.write("\t\t\t\t\t<th width=\"250px\" align=\"left\" style=\"background-color: #ffff;\"><font size=3px>\r\n");
      out.write("\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;Pending with Organization :  <b> ");
      out.print(org);
      out.write("</b>\r\n");
      out.write("\t\t\t\t\t\t\t<INPUT Type=\"hidden\" name=\"org1\" id=\"org1\" value=\"");
      out.print(org );
      out.write("\" />\r\n");
      out.write("\t\t\t\t\t</font></th>\r\n");
      out.write("\t\t\t\t\t");

					}
				
	
      out.write("</tr></table>\r\n");
      out.write("\t<INPUT Type=\"hidden\" name=\"message1\" id=\"message1\" value=\"");
      out.print(header );
      out.write("\" />\r\n");
      out.write("\t<br>\r\n");
      out.write("\t");

	String url2=null;
	
		Date dateofsub;
		Date currentdate;
		Date pDate;
		Connection conn = null;
		Statement stmt = null;
		ResultSet rs = null,rs11=null;
		String arguments=null;
		Context initCtx = new InitialContext();
		Context envCtx = (Context) initCtx.lookup("java:comp/env");
		DataSource ds = (DataSource) envCtx.lookup("jdbc/MySQLDB");

		conn = ds.getConnection();
	
		String query = "select DISTINCT docm.Document_Map_ID,projm.PIU_of_RVNL,projm.Project,projm.Project_Coordinator,pkgm.package_name,projm.CoordinatingDepartment,projm.Designation,docm.Document_Type,docm.Document_Number,docm.Document_Name,docm.Date_of_Submission,docm.Document_status,ram.CurrentDate,ram.ActionPerformedBy,DATEDIFF(CURDATE(),docm.Date_of_Submission) as Aging,bmax.date1,BMR.Department, DATEDIFF(ifnull(ram.ActionedOn,now()),ifnull(ram.CurrentDate,docm.date_of_submission)) as pendingsince, BMR.ActionPerformed, BMR.tot_aging, docm.Zone,BMR.division, loc1.Major_Section, docm.From_Km, docm.To_Km, loc1.Station_Name, loc1.Station_Km, projm.Project_Type from xx_projectattributes_master projm,xx_packages_project pkgm,xx_document_mapping docm,xx_approval_workflow wfm,xx_record_actions ram,(select division,  department, ActionPerformed, document_id, sum(BMR_aging) as tot_aging  from (select if(b.type<>'MOR', if(c.division_hierarchyId <>null,c.division, 'Headquarters'), e.division_name) as division, if(b.type='RVNL','RVNL',if(b.Type='Others', om.Org_Name,d.Department_Name)) as Department, a.ActionPerformed, a.Document_id, DATEDIFF(ifnull(a.ActionedOn,now()),ifnull(a.CurrentDate,c.date_of_submission)) as BMR_Aging from xx_record_actions a left join xx_user_master b on a.ActionPerformedBy=b.User_name left join xx_document_mapping c on a.Document_id=c.Document_Map_ID left join xx_departments_master d on b.Department_id=d.Department_id left join xx_divisions_map e on b.Division_ID=e.division_id left join xx_org_master om on b.Org_ID = om.Org_Id ) as BMR1  group by division,  Department, ActionPerformed, document_id) BMR, (select distinct((select max(ram1.Rownum) date1 from xx_record_actions ram1 where ram1.document_id = ram.document_id)) as date1,ram.Document_id from xx_record_actions ram) bmax, (select a.Document_Map_ID, b.Major_Section, c.Station_Km, c.Station_Name from xx_document_mapping a left join xx_project_km b on a.Majsec_Id = b.Majsec_Id left join xx_project_station c on a.Stn_Id = c.Stn_Id ) loc1 where projm.project_id = docm.project_id and docm.Document_Map_ID = loc1.Document_Map_ID and ram.Document_id = wfm.Document_id and docm.document_Map_id=BMR.document_Id and ram.Rownum = bmax.date1 and projm.Project_ID = pkgm.Project_ID and pkgm.package_id = docm.Package_ID and docm.Document_Map_ID = ram.Document_id and docm.Document_Map_ID=wfm.Document_id and bmax.Document_id= ram.Document_id and docm.ShowInReport='y'";
				
		
		if (piu1 != "") {
			query=query+" and projm.PIU_of_RVNL='"+piu1+"'";
			url2="ReportPIU.jsp?PIU_name="+URLEncoder.encode(piu1, "UTF-8");

		}
		if (projtype != "") {
			query=query+"  and projm.Project_Type='"+projtype+"'";
			if (url2!=null) {
				url2=url2+"&projtype="+projtype;
			} else { url2="ReportPIU.jsp?projtype="+projtype;
			}
		}

		if (project != "") {
			query=query+" and projm.Project='"+project+"'";
			if (url2!=null) {
				url2=url2+"&project="+project;
			} else { url2="ReportPIU.jsp?project="+URLEncoder.encode(project, "UTF-8");
			}
		}
		if (docType != "") {
			query=query+"  and docm.Document_Type='"+docType2+"'";
			if (url2!=null) {
				url2=url2+"&docType="+docType;
			} else { url2="ReportPIU.jsp?docType="+docType;
			}	
		}
		if (status != "") {
			query=query+" and docm.Document_Status='"+status+"'";
			if (url2!=null) {
				url2=url2+"&status="+status;
			} else { url2="ReportPIU.jsp?status="+status;
			}
		}
		if(sDate!="" && eDate!=""){
			


	Date sDate1 = new SimpleDateFormat("dd/MM/yyyy").parse(sDate);
	SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
	String sDatefin = formatter.format(sDate1);


	Date eDate1 = new SimpleDateFormat("dd/MM/yyyy").parse(eDate);
	SimpleDateFormat formatter1 = new SimpleDateFormat("yyyy-MM-dd");
	String eDatefin = formatter1.format(eDate1);

			query=query+" and docm.Date_of_Submission  >= '"+sDatefin+"' and docm.Date_of_Submission <= '"+eDatefin+"' ";
			if (url2!=null) {
				url2=url2+"&DateStart="+sDate+"&DateEnd="+eDate;
			} else { url2="ReportPIU.jsp?DateStart="+sDate+"&DateEnd="+eDate;
			}
		} 
		if((!zone.equalsIgnoreCase("")) || (zone.equalsIgnoreCase("none"))){
			
			if(!division.equalsIgnoreCase("") ){
				  
				query=query+"  and docm.Zone='"+zone+"'";
				 query=query+"  and BMR.Division='"+division+"'";
				 if (url2!=null) {
						url2=url2+"&zone="+zone+"&division="+division;
					} else { url2="ReportPIU.jsp?zone="+zone+"&division="+division;
					}
				
			}else{
			
			   
			   
			query=query+"  and docm.Zone='"+zone+"'";
			   
			 if (url2!=null) {
					url2=url2+"&zone="+zone;
				} else { url2="ReportPIU.jsp?zone="+zone;
				}
			
			   
			}
		}
		
		if (majsec != "") {
			query=query+" and loc1.Major_Section='"+majsec+"'";
		}
		if (smajsec != "") {
			query=query+" and loc1.Major_Section='"+smajsec+"'";
		}
		String bigkm=null, smallkm=null;
		if (tokm != ""  && frmkm != "") {
		if (Double.parseDouble(tokm) > Double.parseDouble(frmkm)) {
			 bigkm=tokm;
			 smallkm=frmkm;
		} else {
			 bigkm=frmkm;
			 smallkm=tokm;
		}
		}
		 
		if (frmkm != "") {
			if (tokm != "") {
		query=query+" and ((docm.From_Km>="+smallkm+ " and docm.From_Km<="+bigkm+") or (docm.To_Km>="+smallkm+ " and docm.To_Km<="+bigkm+") or (loc1.Station_Km>="+smallkm+" and loc1.Station_Km<="+bigkm+"))";
			} else {query=query+" and (docm.From_Km>="+frmkm+ " or docm.To_Km>="+frmkm+" or loc1.Station_km>="+frmkm+")";}
		} else {
			if (tokm != "") {
					query=query+" and (docm.From_Km<="+tokm+ " or docm.To_Km<="+tokm+" or loc1.Station_km<="+tokm+")";}
		}

		String bigkm1=null, smallkm1=null;
		if (tostnkm != ""  && frmstnkm != "") {
		if (Double.parseDouble(tostnkm) > Double.parseDouble(frmstnkm)) {
			 bigkm1=tostnkm;
			 smallkm1=frmstnkm;
		} else {
			 bigkm1=frmstnkm;
			 smallkm1=tostnkm;
		}
		}
	System.out.println("from stn km"+frmstnkm+"to km"+tostnkm);
		if (frmstnkm != "") {
			if (tostnkm != "") {
		  query=query+" and ((docm.From_Km>="+smallkm1+ " and docm.From_Km<="+bigkm1+") or (docm.To_Km>="+smallkm1+ " and docm.To_Km<="+bigkm1+") or (loc1.Station_Km>="+smallkm1+" and loc1.Station_Km<="+bigkm1+"))";
		 } else {query=query+" and (docm.From_Km>="+frmstnkm+ " or docm.To_Km>="+frmstnkm+" or loc1.Station_km>="+frmstnkm+")";}
		} else {
			if (tostnkm != "") {query=query+" and (docm.From_Km<="+tostnkm+ " or docm.To_Km<="+tostnkm+" or loc1.Station_km<="+tostnkm+")";}
		}
		if (org != "") {
			query=query+" and BMR.Department='"+org+"'";
		}
		String query1="select zone, division,  Department,  Round(avg(if (ActionPerformed='Finally Approved'  or ActionPerformed='Forward With Approval' or ActionPerformed='Returned to RVNL with approval' ,tot_Aging,null)),2) AS Sum_mor,  Count(if (ActionPerformed='Finally Approved'  or ActionPerformed='Forward With Approval' or ActionPerformed='Returned to RVNL with approval' ,1, null)) AS Fin_doc,  Count(if (document_status='Pending' and ActionPerformed='pending' and cast(pendingsince as signed integer)<="+t1+",1,null)) AS Pending_doc1, Count(if (document_status='Pending' and ActionPerformed='pending' and cast(pendingsince as signed integer) between "+ (t1+1) + " and " +t2+",1,null)) AS Pending_doc2, Count(if (document_status='Pending' and ActionPerformed='pending' and cast(pendingsince as signed integer)>"+t2+",1,null)) AS Pending_doc3, pendingsince, sum(if (ActionPerformed='Finally Approved'  or ActionPerformed='Forward With Approval' or ActionPerformed='Returned to RVNL with approval' ,tot_Aging,null)) AS Sum_mor_sum from (" + query+ ") as pkqry group by  zone, division, department";
		
				//"select zone, division,  Department,  Round(avg(if (document_status='Finally Approved' and ActionPerformed='Finally Approved',tot_Aging,null)),2) AS Sum_mor,  Count(if (document_status='Finally Approved' and ActionPerformed='Finally Approved',1, null)) AS Fin_doc,  Count(if (document_status='Pending' and ActionPerformed='pending' and cast(pendingsince as signed integer)<="+t1+",1,null)) AS Pending_doc1, Count(if (document_status='Pending' and ActionPerformed='pending' and cast(pendingsince as signed integer) between "+ (t1+1) + " and " +t2+",1,null)) AS Pending_doc2, Count(if (document_status='Pending' and ActionPerformed='pending' and cast(pendingsince as signed integer)>"+t2+",1,null)) AS Pending_doc3, pendingsince from (" + query+ ") as pkqry group by  zone, division, department";
		
		stmt = conn.createStatement();
		rs = stmt.executeQuery(query1);
		
			
	
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t<table border=1 class=\"table table-hover table-bordered\"\r\n");
      out.write("\t\tstyle=\"background-color: #F0FFFF\" id=\"example\" class=\"display nowrap\" cellspacing=\"0\" width=\"100%\">\r\n");
      out.write("\t\t<thead>\r\n");
      out.write("\t\t<tr class=\"success\">\r\n");
      out.write("\t\t\t<th width=\"50px\" style=\"padding: 0px 14px 24px 0px;\">S.No.</th>\r\n");
      out.write("\t\t\t");
 int n=3;
				if (zone == "") {
			
      out.write("\r\n");
      out.write("\t\t\t<th width=\"120px\" style=\"padding: 0px 88px 27px 54px;\">Zone</th>\r\n");
      out.write("\t\t\t");

				} else {n--; }
			
      out.write("\r\n");
      out.write("\t\t\t");

				if (division == "") {
			
      out.write("\r\n");
      out.write("\t\t\t<th width=\"150px\"  style=\"padding: 0px 0px 26px 19px;\">Division</th>\r\n");
      out.write("\t\t\t");

				} else {n--; }
			
      out.write("\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t<th width=\"120px\">Department</th>\r\n");
      out.write("\t\t\t<th width=\"90px\">Nos. Cleared</th>\r\n");
      out.write("\t\t\t<th width=\"90px\">Avg time taken for approval (days)</th>\r\n");
      out.write("\t\t\t<th width=\"120px\">Nos. pending with Current User (upto ");
      out.print(t1 );
      out.write(" days)</th>\r\n");
      out.write("\t\t\t<th width=\"120px\">Nos. pending with Current User (");
      out.print(t1+1 );
      out.write(" to ");
      out.print(t2 );
      out.write(" days)</th>\r\n");
      out.write("\t\t\t<th width=\"120px\">Nos. pending with Current User (more than ");
      out.print(t2 );
      out.write(" days)</th>\r\n");
      out.write("\t\t\t<th width=\"120px\">Time taken for approval (days)</th>\r\n");
      out.write("\t\t</tr></thead>\r\n");
      out.write("\t\t<tfoot>\t\r\n");
 n++;
int c=1;

      out.write("\r\n");
      out.write("<th colspan='");
      out.print(n );
      out.write("'><center><b>Total</b></center></th>\r\n");
 while (c<7) {

      out.write("\r\n");
      out.write("<th></th>\r\n");

System.out.println("ccc"+c+"n"+n);
c++;
} 
      out.write("\r\n");
      out.write("\t\t</tfoot>\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t<tbody>\r\n");
      out.write("\t\t");
 int i=1;
		   	while (rs.next()) {

				String Zone_name = rs.getString(1);
				String division1 = rs.getString(2);
				//String piu = rs.getString(3);
				String dept = rs.getString(3);
				//String proj = rs.getString(4);
				//String packn = rs.getString(5);
				String appd = rs.getString(5);
				String sum_mor = rs.getString(4);
				String sum_mor_sum= rs.getString(10);
				String pending1 = rs.getString(6);
				String pending2 = rs.getString(7);
				String pending3 = rs.getString(8);
				 
							
			
      out.write("\r\n");
      out.write("\t\t<tr class=\"active\">\r\n");
      out.write("\t\t\t<td>");
      out.print(i);
      out.write("</td>\r\n");
      out.write("\t\t\t");

				if (zone != "") {
			
      out.write("\r\n");
      out.write("\t\t\t");

				} else {
			
      out.write("\t\t\r\n");
      out.write("\t\t\t<td>");
      out.print(Zone_name);
      out.write("</td>\r\n");
      out.write("\t\t\t");

			Zone_name = URLEncoder.encode(Zone_name, "UTF-8");
				}
			
      out.write("\r\n");
      out.write("\t\t\t");

				if (division != "") {
			
      out.write("\r\n");
      out.write("\t\t\t");

				} else {
			
      out.write("\t\t\r\n");
      out.write("\t\t\t<td>");
      out.print(division1);
      out.write("</td>\r\n");
      out.write("\t\t\t");

			System.out.println("000"+division1);
			division1 = URLEncoder.encode(division1, "UTF-8");
				}
			
      out.write("\r\n");
      out.write("\t\t\t<td>");
      out.print(dept);
      out.write("</td>\r\n");
      out.write("\t\t\t");

			//System.out.println("111"+project+"22"+piu1);
			String project2 = URLEncoder.encode(project, "UTF-8");
			String piu2 = URLEncoder.encode(piu1, "UTF-8");
			String dept2 = URLEncoder.encode(dept, "UTF-8");
			String majsec2 = URLEncoder.encode(majsec, "UTF-8");
			String smajsec2 = URLEncoder.encode(smajsec, "UTF-8");
			String org2 = URLEncoder.encode(org, "UTF-8");
			//System.out.println("111"+project2+"22"+piu2);
			String url21="ReportPIU_Spl_details.jsp?zone="+Zone_name+"&division="+division1+"&dept="+dept+"&PIU_name="+piu2+"&project="+project2+"&status="+status+"&docType="+docType+"&DateStart="+sDate+"&DateEnd="+eDate+"&t1=0&t2=0&majsec="+majsec2+"&smajsec="+smajsec2+"&frmkm="+frmkm+"&tokm="+tokm+"&frmstn="+frmstn+"&tostn="+tostn+"&frmstnkm="+frmstnkm+"&tostnkm="+tostnkm+"&orgName="+org2;
			String url31=url21.replace(" ","+");
			String url41="ReportPIU_Spl_details.jsp?zone="+Zone_name+"&division="+division1+"&dept="+dept+"&PIU_name="+piu2+"&project="+project2+"&status="+status+"&docType="+docType+"&DateStart="+sDate+"&DateEnd="+eDate+"&t1="+t1+"&t2="+t2+"&majsec="+majsec2+"&smajsec="+smajsec2+"&frmkm="+frmkm+"&tokm="+tokm+"&frmstn="+frmstn+"&tostn="+tostn+"&frmstnkm="+frmstnkm+"&tostnkm="+tostnkm+"&orgName="+org2;
			String url51=url41.replace(" ","+");
			if (appd.equalsIgnoreCase("0")) {
			
      out.write("\r\n");
      out.write("\t\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t");
	} else {
			
      out.write("\r\n");
      out.write("\t\t\t<td><center><a href=\"");
      out.print(url31 );
      out.write("&tcode=5\">");
      out.print(appd);
      out.write("</a></center></td>\r\n");
      out.write("\t\t\t");
 } 
			if (sum_mor==null) {
			
      out.write("\r\n");
      out.write("\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t");
	} else {
			
      out.write("\r\n");
      out.write("\t\t\t<td><center>");
      out.print(sum_mor);
      out.write("</center></td>\r\n");
      out.write("\t\t\t");
}
			if (pending1.equalsIgnoreCase("0")) {
				
      out.write("\r\n");
      out.write("\t\t\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t\t");
	} else {
				
      out.write("\r\n");
      out.write("\t\t\t\t\t<td><center><a href=\"");
      out.print(url51 );
      out.write("&tcode=1\">");
      out.print(pending1 );
      out.write("</a></center></td>\r\n");
      out.write("\t\t\t\t\t");
 } 
				
			if (pending2.equalsIgnoreCase("0")) {
			
      out.write("\r\n");
      out.write("\t\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t");
	} else {
			
      out.write("\r\n");
      out.write("\t\t\t\t<td><center><a href=\"");
      out.print(url51 );
      out.write("&tcode=2\">");
      out.print(pending2 );
      out.write("</a></center></td>\r\n");
      out.write("\t\t\t\t");
 } 
			
		if (pending3.equalsIgnoreCase("0")) {
			
      out.write("\r\n");
      out.write("\t\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t");
	} else {
			
      out.write("\r\n");
      out.write("\t\t\t\t<td><center><a href=\"");
      out.print(url51 );
      out.write("&tcode=3\">");
      out.print(pending3 );
      out.write("</a></center></td>\r\n");
      out.write("\t\t\t\t");
 } 
		if (sum_mor_sum==null) {
			
      out.write("\r\n");
      out.write("\t\t\t<td><center>-</center></td>\r\n");
      out.write("\t\t\t");
	} else {
			
      out.write("\r\n");
      out.write("\t\t\t<td><center>");
      out.print(sum_mor_sum);
      out.write("</center></td>\r\n");
      out.write("\t\t\t");
}
			
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t</tr>\r\n");
      out.write("\t\t");

		i++;
			}
		
      out.write("\r\n");
      out.write("\t\t</tbody>\r\n");
      out.write("\t</table>\r\n");
      out.write("\t<br>\r\n");
      out.write("\t\t<input type=\"button\" value=\"close\" class=\"btn btn-primary\" onclick=\"closeMe();\" style=\"margin-left: 50%;\"> \r\n");
      out.write("\t<br><br>\r\n");
      out.write("\t");

		if (exportToExcel == null) {
	
	
		}
	   try { conn.close(); } catch (Exception e) { /* ignored */ }
	
      out.write("\r\n");
      out.write("\t<br>\r\n");
      out.write("\t<!-- <a href=\"#\" onclick=\"javascript:window.print();\">Print this page</a> -->\r\n");
      out.write("\r\n");
      out.write("</body>\r\n");
      out.write("\r\n");
      out.write("</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
